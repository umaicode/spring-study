# ìŠ¤í”„ë§ DB ì ‘ê·¼ ê¸°ìˆ 

> ë©”ëª¨ë¦¬ ì €ì¥ì†Œì—ì„œ ì‹¤ì œ DBë¡œ - ìˆœìˆ˜ JDBCë¶€í„° Spring Data JPAê¹Œì§€ ê¸°ìˆ  ì§„í™” ì²´í—˜

## ğŸ“š ê°•ì˜ ì¶œì²˜

**ì¸í”„ëŸ° - ê¹€ì˜í•œì˜ "ìŠ¤í”„ë§ ì…ë¬¸ - ì½”ë“œë¡œ ë°°ìš°ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸, ì›¹ MVC, DB ì ‘ê·¼ ê¸°ìˆ "**

ì´ ë¬¸ì„œëŠ” ê°•ì˜ì˜ "ìŠ¤í”„ë§ DB ì ‘ê·¼ ê¸°ìˆ " ì„¹ì…˜ì„ í•™ìŠµí•˜ë©° ì‘ì„±í•œ ë…¸íŠ¸ì…ë‹ˆë‹¤. H2 ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ì—¬ ìˆœìˆ˜ JDBC â†’ JdbcTemplate â†’ JPA â†’ Spring Data JPAë¡œ ì €ì¥ì†Œ êµ¬í˜„ì²´ë¥¼ ì ì§„ì ìœ¼ë¡œ êµì²´í•˜ë©´ì„œ, ìŠ¤í”„ë§ì˜ ê°œë°©-íì‡„ ì›ì¹™(OCP)ê³¼ ì˜ì¡´ì„± ì£¼ì…(DI)ì˜ ì§„ì§œ í˜ì„ ì²´ë“í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

---

## ğŸ¯ í•™ìŠµ ëª©í‘œ

ì´ ë¬¸ì„œë¥¼ í†µí•´ ë‹¤ìŒì„ ì´í•´í•˜ê³  ì‹¤ìŠµí•©ë‹ˆë‹¤:

1. **H2 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ë° DDL ì‘ì„±**
   - H2 ì„ë² ë””ë“œ DBë¥¼ ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ ì—°ë™í•˜ëŠ” ë°©ë²•
   - `application.properties`ì™€ `build.gradle` ì„¤ì •

2. **ìˆœìˆ˜ JDBC êµ¬í˜„ê³¼ ê·¸ í•œê³„**
   - `DataSource`, `Connection`, `PreparedStatement`, `ResultSet` ì§ì ‘ ê´€ë¦¬
   - `DataSourceUtils`ë¥¼ í†µí•œ íŠ¸ëœì­ì…˜ ì•ˆì „ ì»¤ë„¥ì…˜ íšë“

3. **ê°œë°©-íì‡„ ì›ì¹™(OCP) - DIì˜ ì§„ì§œ í˜**
   - ê¸°ì¡´ ì½”ë“œ(`MemberService` ë“±) ë¥¼ ì „í˜€ ìˆ˜ì •í•˜ì§€ ì•Šê³  êµ¬í˜„ì²´ë§Œ êµì²´
   - `SpringConfig`ì—ì„œ `@Bean` ë°˜í™˜ê°’ë§Œ ë°”ê¿”ì„œ ì™„ë£Œ

4. **ìŠ¤í”„ë§ í†µí•© í…ŒìŠ¤íŠ¸ (`@SpringBootTest`, `@Transactional`)**
   - ì‹¤ì œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ë„ì›Œ ì§„í–‰í•˜ëŠ” í†µí•© í…ŒìŠ¤íŠ¸
   - `@Transactional`ì´ í…ŒìŠ¤íŠ¸ì—ì„œ ë¡¤ë°±ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì›ë¦¬

5. **JdbcTemplateìœ¼ë¡œ ë°˜ë³µ ì½”ë“œ ì œê±°**
   - `RowMapper`ì™€ ëŒë‹¤ë¡œ ê²°ê³¼ ë§¤í•‘
   - `SimpleJdbcInsert`ë¡œ INSERT ì¿¼ë¦¬ ìë™ ìƒì„±

6. **JPA - ORM íŒ¨ëŸ¬ë‹¤ì„ ì „í™˜**
   - `@Entity`, `@Id`, `@GeneratedValue` ë§¤í•‘
   - `EntityManager`ì™€ JPQLë¡œ ê°ì²´ ê¸°ë°˜ ì¿¼ë¦¬

7. **Spring Data JPA - ì¸í„°í˜ì´ìŠ¤ë§Œìœ¼ë¡œ êµ¬í˜„ ì™„ì„±**
   - `JpaRepository` ìƒì†ë§Œìœ¼ë¡œ ê¸°ë³¸ CRUD ìë™ ì œê³µ
   - ë©”ì„œë“œ ì´ë¦„ ê·œì¹™ìœ¼ë¡œ ì¿¼ë¦¬ ìë™ ìƒì„±

---

## ğŸ—ºï¸ í•™ìŠµ ë¡œë“œë§µ (ê¸°ìˆ  ì§„í™” íë¦„)

ì´ ë¬¸ì„œëŠ” **ê¸°ìˆ  ì§„í™” ìˆœì„œ** ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê°™ì€ `MemberRepository` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì ì  ê°œì„ í•´ê°€ë©°, ê° ê¸°ìˆ ì´ ì–´ë–¤ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ”ì§€ë¥¼ ì²´ê°í•©ë‹ˆë‹¤.

```
[ê¸°ìˆ  ì§„í™” - ì½”ë“œ ì–‘ vs í¸ì˜ì„±]

MemoryMemberRepository   â†’   JdbcMemberRepository   â†’   JdbcTemplateMemberRepository
  (ë©”ëª¨ë¦¬, 0ì¤„ ì„¤ì •)            (ìˆœìˆ˜ JDBC, ~200ì¤„)           (JdbcTemplate, ~50ì¤„)
                                                                     â†“
                                             SpringDataJpaMemberRepository   â†   JpaMemberRepository
                                              (ì¸í„°í˜ì´ìŠ¤ 3ì¤„!)                     (JPA, ~20ì¤„)
```

**ì™œ ì´ ìˆœì„œì¸ê°€?**
- **ë¬¸ì œ â†’ í•´ê²° íŒ¨í„´**: ê° ê¸°ìˆ ì˜ ë“±ì¥ ë°°ê²½(ì „ ê¸°ìˆ ì˜ ë‹¨ì )ì„ ì§ì ‘ ì²´ê°í•œ ë’¤ ë‹¤ìŒ ê¸°ìˆ ì„ ë°°ì›ë‹ˆë‹¤.
- **OCP ë°˜ë³µ ì²´í—˜**: `SpringConfig`ì—ì„œ `@Bean` ë°˜í™˜ê°’ë§Œ êµì²´í•˜ëŠ” ì‘ì—…ì„ ë§¤ ë‹¨ê³„ ë°˜ë³µí•˜ë©°, DIê°€ ì™œ ê°•ë ¥í•œì§€ ì§ì ‘ ëŠë‚ë‹ˆë‹¤.

---

## ğŸ“– ëª©ì°¨

1. [H2 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì¹˜ ë° ì„¤ì •](#1-h2-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ì¹˜-ë°-ì„¤ì •)
2. [ìˆœìˆ˜ JDBC](#2-ìˆœìˆ˜-jdbc)
3. [ìŠ¤í”„ë§ í†µí•© í…ŒìŠ¤íŠ¸](#3-ìŠ¤í”„ë§-í†µí•©-í…ŒìŠ¤íŠ¸)
4. [ìŠ¤í”„ë§ JdbcTemplate](#4-ìŠ¤í”„ë§-jdbctemplate)
5. [JPA](#5-jpa)
6. [ìŠ¤í”„ë§ ë°ì´í„° JPA](#6-ìŠ¤í”„ë§-ë°ì´í„°-jpa)
7. [DB ì ‘ê·¼ ê¸°ìˆ  ì§„í™” ë¹„êµ](#7-db-ì ‘ê·¼-ê¸°ìˆ -ì§„í™”-ë¹„êµ)
8. [Best Practice ë° ì•ˆí‹°íŒ¨í„´](#8-best-practice-ë°-ì•ˆí‹°íŒ¨í„´)
9. [ë¶€ë¡](#9-ë¶€ë¡)

---

## 1. H2 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì¹˜ ë° ì„¤ì •

### 1.1 H2ë€?

H2ëŠ” ìë°”ë¡œ ë§Œë“¤ì–´ì§„ ê²½ëŸ‰ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤. ê°œë°œ ë° í•™ìŠµ í™˜ê²½ì—ì„œ ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤.

| íŠ¹ì§• | ì„¤ëª… |
|------|------|
| **ê²½ëŸ‰** | ë³„ë„ ì„¤ì¹˜ ì—†ì´ JAR í•˜ë‚˜ë¡œ ì‹¤í–‰ |
| **ì›¹ ì½˜ì†”** | ë¸Œë¼ìš°ì €ì—ì„œ SQLì„ ì§ì ‘ ì‹¤í–‰ ê°€ëŠ¥ |
| **í˜¸í™˜ì„±** | MySQLê³¼ ìœ ì‚¬í•œ SQL ë¬¸ë²• ì§€ì› |
| **í•™ìŠµìš©** | ì‹¤ë¬´ì—ì„œëŠ” MySQL, PostgreSQL ë“±ì„ ì‚¬ìš©í•˜ì§€ë§Œ ë¡œì»¬ ê°œë°œ/í…ŒìŠ¤íŠ¸ì— ì í•© |

### 1.2 DDL - member í…Œì´ë¸” ìƒì„±

H2 ì›¹ ì½˜ì†”(`http://localhost:8082`)ì— ì ‘ì†í•´ ì•„ë˜ DDLì„ ì‹¤í–‰í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤.

```sql
drop table if exists member CASCADE;
create table member
(
    id   bigint generated by default as identity,
    name varchar(255),
    primary key (id)
);
```

| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| `id` | `bigint` | ê¸°ë³¸í‚¤. `generated by default as identity`ë¡œ DBê°€ ìë™ ìƒì„± |
| `name` | `varchar(255)` | íšŒì› ì´ë¦„ |

> `generated by default as identity`: H2ì˜ ìë™ ì¦ê°€(AUTO_INCREMENT) ë¬¸ë²•. JPAì˜ `GenerationType.IDENTITY`ì™€ ì—°ê²°ë©ë‹ˆë‹¤.

### 1.3 application.properties / build.gradle ì„¤ì •

**`src/main/resources/application.properties`**

```properties
spring.application.name=hello-spring

# JDBC ì„¤ì •
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# JPA ì„¤ì •
# JPAê°€ ë‚ ë¦¬ëŠ” SQLì„ ì½˜ì†”ì—ì„œ ë³¼ ìˆ˜ ìˆê²Œ í•œë‹¤.
spring.jpa.show-sql=true
# JPAê°€ Entityë¥¼ ë³´ê³  ìë™ìœ¼ë¡œ í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥. noneì´ë©´ ëˆë‹¤.
spring.jpa.hibernate.ddl-auto=none
```

**`build.gradle`**

```groovy
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    implementation 'org.springframework.boot:spring-boot-starter-webmvc'

    // JDBC ë°©ì‹ (JPAì— í¬í•¨ë˜ì–´ ìˆì–´ ë‹¨ë… ì„ ì–¸ ë¶ˆí•„ìš”)
    // implementation 'org.springframework.boot:spring-boot-starter-jdbc'

    // JPA (JDBC í¬í•¨)
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'

    // H2 ë°ì´í„°ë² ì´ìŠ¤ (ëŸ°íƒ€ì„ì—ë§Œ í•„ìš”)
    runtimeOnly 'com.h2database:h2'
}
```

**ì„¤ì • íë¦„:**

```
application.properties (datasource URL, username, password)
        â†“
ìŠ¤í”„ë§ ë¶€íŠ¸ ìë™ êµ¬ì„±
        â†“
DataSource ë¹ˆ ìë™ ìƒì„± (ìŠ¤í”„ë§ì´ ì œê³µ)
        â†“
JdbcTemplate / EntityManager ë“±ì´ DataSourceë¥¼ ì£¼ì…ë°›ì•„ ë™ì‘
```

---

## 2. ìˆœìˆ˜ JDBC

### 2.1 JdbcMemberRepository êµ¬í˜„

ìˆœìˆ˜ JDBCëŠ” ìë°” í‘œì¤€ API(`java.sql.*`)ë¥¼ ì§ì ‘ ì‚¬ìš©í•©ë‹ˆë‹¤. ì½”ë“œê°€ ê¸¸ê³  ë°˜ë³µì ì´ì§€ë§Œ, DB ì—°ë™ì˜ ì›ë¦¬ë¥¼ ì´í•´í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.

```java
public class JdbcMemberRepository implements MemberRepository {

    private final DataSource dataSource;

    public JdbcMemberRepository(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    @Override
    public Member save(Member member) {
        String sql = "insert into member(name) values(?)";

        Connection conn = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;

        try {
            conn = getConnection();
            // RETURN_GENERATED_KEYS: INSERT í›„ ìƒì„±ëœ idë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ í•„ìš”
            pstmt = conn.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            pstmt.setString(1, member.getName());
            pstmt.executeUpdate();  // ì‹¤ì œ DBì— ì¿¼ë¦¬ ì „ì†¡

            rs = pstmt.getGeneratedKeys();
            if (rs.next()) {
                member.setId(rs.getLong(1));
            } else {
                throw new SQLException("id ì¡°íšŒ ì‹¤íŒ¨");
            }
            return member;
        } catch (Exception e) {
            throw new IllegalStateException(e);
        } finally {
            close(conn, pstmt, rs);  // ë°˜ë“œì‹œ ìì› í•´ì œ
        }
    }

    // findById, findByName, findAll - ê°™ì€ íŒ¨í„´ ë°˜ë³µ...
}
```

**save() íë¦„:**

```
1. getConnection()       â†’ DB ì»¤ë„¥ì…˜ íšë“ (DataSourceUtils ê²½ìœ )
        â†“
2. prepareStatement()    â†’ SQL ì¤€ë¹„ (RETURN_GENERATED_KEYS ì˜µì…˜)
        â†“
3. setString(1, name)    â†’ ? íŒŒë¼ë¯¸í„°ì— ê°’ ë°”ì¸ë”©
        â†“
4. executeUpdate()       â†’ DBì— INSERT ì‹¤í–‰
        â†“
5. getGeneratedKeys()    â†’ DBê°€ ìƒì„±í•œ id ì¡°íšŒ
        â†“
6. member.setId(...)     â†’ Member ê°ì²´ì— id ì„¤ì •
        â†“
7. finally: close()      â†’ Connection, PreparedStatement, ResultSet ìì› í•´ì œ
```

### 2.2 DataSourceì™€ DataSourceUtils

```java
private Connection getConnection() {
    // DataSourceUtilsë¥¼ í†µí•´ ì»¤ë„¥ì…˜ì„ íšë“í•´ì•¼ í•œë‹¤.
    // ê°™ì€ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œëŠ” ê°™ì€ ì»¤ë„¥ì…˜ì„ ì¬ì‚¬ìš©í•œë‹¤.
    return DataSourceUtils.getConnection(dataSource);
}

private void close(Connection conn) throws SQLException {
    // ì»¤ë„¥ì…˜ë„ DataSourceUtilsë¥¼ í†µí•´ ë°˜í™˜í•´ì•¼ í•œë‹¤.
    DataSourceUtils.releaseConnection(conn, dataSource);
}
```

| í•­ëª© | ì§ì ‘ `dataSource.getConnection()` | `DataSourceUtils.getConnection()` |
|------|----------------------------------|----------------------------------|
| **íŠ¸ëœì­ì…˜ ì—°ë™** | âŒ ë§¤ë²ˆ ìƒˆ ì»¤ë„¥ì…˜ | âœ… ê¸°ì¡´ íŠ¸ëœì­ì…˜ì˜ ì»¤ë„¥ì…˜ ì¬ì‚¬ìš© |
| **ìŠ¤í”„ë§ ê¶Œì¥** | âŒ | âœ… |
| **ì‹¤ë¬´ ì‚¬ìš©** | âŒ | âœ… |

> ìŠ¤í”„ë§ì—ì„œ DBë¥¼ ë‹¤ë£° ë•ŒëŠ” **ë°˜ë“œì‹œ `DataSourceUtils`ë¥¼ í†µí•´** ì»¤ë„¥ì…˜ì„ íšë“/ë°˜í™˜í•´ì•¼ íŠ¸ëœì­ì…˜ì´ ì˜¬ë°”ë¥´ê²Œ ë™ì‘í•©ë‹ˆë‹¤.

### 2.3 SpringConfig ë³€ê²½ - êµ¬í˜„ì²´ êµì²´

ê¸°ì¡´ì˜ `MemoryMemberRepository`ë¥¼ `JdbcMemberRepository`ë¡œ êµì²´í•©ë‹ˆë‹¤.

```java
@Configuration
public class SpringConfig {

    private DataSource dataSource;

    @Autowired
    public SpringConfig(DataSource dataSource) {
        this.dataSource = dataSource;  // ìŠ¤í”„ë§ì´ ìë™ ìƒì„±í•œ DataSource ì£¼ì…
    }

    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository());
    }

    @Bean
    public MemberRepository memberRepository() {
        // return new MemoryMemberRepository();  // ì´ì „ ì½”ë“œ
        return new JdbcMemberRepository(dataSource);  // êµì²´!
    }
}
```

**ë³€ê²½ëœ ê²ƒ:** `memberRepository()` ë©”ì„œë“œì˜ ë°˜í™˜ê°’ í•œ ì¤„ë¿ì…ë‹ˆë‹¤.
**ë³€ê²½ë˜ì§€ ì•Šì€ ê²ƒ:** `MemberService`, `MemberController`, í…ŒìŠ¤íŠ¸ ì½”ë“œ, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì „ì²´.

### 2.4 ê°œë°©-íì‡„ ì›ì¹™(OCP) - DIì˜ ì§„ì§œ í˜

```
[OCP êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨]

MemberService â”€â”€â†’ [MemberRepository ì¸í„°í˜ì´ìŠ¤]
                            â†‘
                MemoryMemberRepository  (ê¸°ì¡´)
                JdbcMemberRepository    (êµì²´ 1)
                JdbcTemplateMemberRepository (êµì²´ 2)
                JpaMemberRepository     (êµì²´ 3)
                SpringDataJpaMemberRepository (êµì²´ 4, ìµœì¢…)
```

- **ê°œë°©(Open)**: ìƒˆ êµ¬í˜„ì²´ ì¶”ê°€ì—ëŠ” ì—´ë ¤ ìˆë‹¤ â†’ `JdbcMemberRepository` ë“± ìƒˆ í´ë˜ìŠ¤ë¥¼ ììœ ë¡­ê²Œ ì¶”ê°€
- **íì‡„(Closed)**: ê¸°ì¡´ ì½”ë“œ ìˆ˜ì •ì—ëŠ” ë‹«í˜€ ìˆë‹¤ â†’ `MemberService` ë“± í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë¥¼ ì „í˜€ ìˆ˜ì •í•˜ì§€ ì•ŠìŒ
- **DIì˜ ì—­í• **: ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì¸í„°í˜ì´ìŠ¤ì— êµ¬í˜„ì²´ë¥¼ ì£¼ì…í•´ì£¼ë¯€ë¡œ, í´ë¼ì´ì–¸íŠ¸ëŠ” ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´

---

## 3. ìŠ¤í”„ë§ í†µí•© í…ŒìŠ¤íŠ¸

### 3.1 @SpringBootTest vs ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

| êµ¬ë¶„ | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (`MemberServiceTest`) | í†µí•© í…ŒìŠ¤íŠ¸ (`MemberServiceIntegrationTest`) |
|------|----------------------------------|---------------------------------------------|
| **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ** | âŒ ë„ìš°ì§€ ì•ŠìŒ | âœ… ì‹¤ì œ ì»¨í…Œì´ë„ˆ êµ¬ë™ |
| **DB ì—°ê²°** | âŒ ë©”ëª¨ë¦¬ ì €ì¥ì†Œ ì‚¬ìš© | âœ… ì‹¤ì œ H2 DB ì—°ê²° |
| **ì†ë„** | ë¹ ë¦„ | ëŠë¦¼ |
| **ì˜ì¡´ì„± ì£¼ì…** | ì§ì ‘ newë¡œ ìƒì„± | `@Autowired`ë¡œ ì»¨í…Œì´ë„ˆì—ì„œ ì£¼ì… |
| **ëª©ì ** | íŠ¹ì • í´ë˜ìŠ¤ì˜ ë¡œì§ ê²€ì¦ | ì „ì²´ ì‹œìŠ¤í…œ í†µí•© ë™ì‘ ê²€ì¦ |
| **ê¶Œì¥ë„** | âœ… ìš°ì„  ê¶Œì¥ | í•„ìš” ì‹œ ì‚¬ìš© |

```java
@SpringBootTest   // ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤ì œë¡œ ë„ìš´ë‹¤
@Transactional    // ê° í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì‹¤í–‰ í›„ ë¡¤ë°±
class MemberServiceIntegrationTest {

    @Autowired MemberService memberService;   // ì»¨í…Œì´ë„ˆì—ì„œ ì£¼ì…
    @Autowired MemberRepository memberRepository;

    @Test
    void íšŒì›ê°€ì…() {
        Member member = new Member();
        member.setName("spring");

        Long saveId = memberService.join(member);

        Member findMember = memberService.findOne(saveId).get();
        assertThat(member.getName()).isEqualTo(findMember.getName());
    }
}
```

### 3.2 @Transactionalì˜ í…ŒìŠ¤íŠ¸ ì‹œ ë™ì‘ (ë¡¤ë°±)

`@Transactional`ì€ ì„œë¹„ìŠ¤ ë ˆì´ì–´ì— ë¶™ì„ ë•Œì™€ **í…ŒìŠ¤íŠ¸ì— ë¶™ì„ ë•Œì˜ ë™ì‘ì´ ë‹¤ë¦…ë‹ˆë‹¤.**

```
[í…ŒìŠ¤íŠ¸ì—ì„œì˜ @Transactional ë™ì‘]

í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì‹œì‘
        â†“
íŠ¸ëœì­ì…˜ ì‹œì‘ (begin)
        â†“
memberService.join(member)  â†’  INSERT INTO member(name) VALUES('spring')
        â†“
memberService.findOne(saveId)  â†’  SELECT * FROM member WHERE id = ?
        â†“
assertThat(...).isEqualTo(...)  (ê²€ì¦)
        â†“
í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì¢…ë£Œ
        â†“
ìë™ ë¡¤ë°± (ROLLBACK)  â† DBì— ë°ì´í„°ê°€ ë‚¨ì§€ ì•ŠëŠ”ë‹¤!
```

| ìƒí™© | `@Transactional` ë™ì‘ |
|------|----------------------|
| **ì„œë¹„ìŠ¤/ë¦¬í¬ì§€í† ë¦¬ ë ˆì´ì–´** | ì •ìƒ ë™ì‘ í›„ **ì»¤ë°‹** |
| **í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤/ë©”ì„œë“œ** | í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„ **ë¡¤ë°±** (DBë¥¼ ì›ë˜ ìƒíƒœë¡œ ë³µì›) |

> ë•ë¶„ì— í…ŒìŠ¤íŠ¸ë¥¼ ë°˜ë³µ ì‹¤í–‰í•´ë„ ë°ì´í„°ê°€ ìŒ“ì´ì§€ ì•Šì•„, í•­ìƒ ê¹¨ë—í•œ ìƒíƒœì—ì„œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> ë§Œì•½ ì‹¤ì œë¡œ DBì— ë°ì´í„°ë¥¼ ì»¤ë°‹í•˜ê³  ì‹¶ë‹¤ë©´ `@Commit`ì„ í•¨ê»˜ ë¶™ì´ë©´ ë©ë‹ˆë‹¤.

### 3.3 MemberServiceIntegrationTest ë¶„ì„

ê¸°ì¡´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(`MemberServiceTest`)ì™€ì˜ ì°¨ì´ì :

```java
// ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ - ì§ì ‘ ìƒì„±, @AfterEachë¡œ ì €ì¥ì†Œ ì´ˆê¸°í™” í•„ìš”
class MemberServiceTest {
    MemberService memberService;
    MemoryMemberRepository memberRepository;

    @BeforeEach
    public void beforeEach() {
        memberRepository = new MemoryMemberRepository();
        memberService = new MemberService(memberRepository);
    }

    @AfterEach
    public void afterEach() {
        memberRepository.clearStore();  // í…ŒìŠ¤íŠ¸ í›„ ì§ì ‘ ì´ˆê¸°í™”
    }
}

// í†µí•© í…ŒìŠ¤íŠ¸ - ì»¨í…Œì´ë„ˆì—ì„œ ì£¼ì…, @Transactionalì´ ìë™ ë¡¤ë°±
@SpringBootTest
@Transactional
class MemberServiceIntegrationTest {
    @Autowired MemberService memberService;
    @Autowired MemberRepository memberRepository;
    // @AfterEach ë¶ˆí•„ìš” - ë¡¤ë°±ì´ ìë™ìœ¼ë¡œ ë°ì´í„° ì •ë¦¬
}
```

### 3.4 í†µí•© í…ŒìŠ¤íŠ¸ vs ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë¹„êµ

```
[í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ]

          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   í†µí•© í…ŒìŠ¤íŠ¸     â”‚  â† ì ê²Œ
          â”‚ (E2E, @SpringBoot)â”‚
          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
          â”‚   ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸   â”‚
          â”‚ (ë‹¨ìœ„ í…ŒìŠ¤íŠ¸)     â”‚  â† ë§ê²Œ
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ê°€ê¸‰ì ì´ë©´ **ìˆœìˆ˜í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**ë¥¼ ë§ì´ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì—†ì´ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ê°€ ì˜ ëœ ì½”ë“œì¼ìˆ˜ë¡ ì¢‹ì€ ì½”ë“œì¼ í™•ë¥ ì´ ë†’ìŠµë‹ˆë‹¤.

---

## 4. ìŠ¤í”„ë§ JdbcTemplate

### 4.1 ìˆœìˆ˜ JDBC ëŒ€ë¹„ ê°œì„ ì 

JdbcTemplateì€ ìˆœìˆ˜ JDBCì˜ **ë°˜ë³µ ì½”ë“œë¥¼ ì œê±°**í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œë„ ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤.

| í•­ëª© | ìˆœìˆ˜ JDBC | JdbcTemplate |
|------|-----------|-------------|
| **ì»¤ë„¥ì…˜ ê´€ë¦¬** | ì§ì ‘ íšë“/í•´ì œ | ìë™ |
| **ì˜ˆì™¸ ì²˜ë¦¬** | try-catch í•„ìˆ˜ | ìë™ (ìŠ¤í”„ë§ ì˜ˆì™¸ë¡œ ë³€í™˜) |
| **SQL ì‘ì„±** | ì§ì ‘ ì‘ì„± | ì§ì ‘ ì‘ì„± (ë™ì¼) |
| **ê²°ê³¼ ë§¤í•‘** | ResultSet ì§ì ‘ ì²˜ë¦¬ | RowMapperë¡œ ìœ„ì„ |
| **ì½”ë“œ ì–‘** | ~200ì¤„ | ~50ì¤„ |

### 4.2 JdbcTemplateMemberRepository êµ¬í˜„

```java
public class JdbcTemplateMemberRepository implements MemberRepository {

    private final JdbcTemplate jdbcTemplate;

    public JdbcTemplateMemberRepository(DataSource dataSource) {
        jdbcTemplate = new JdbcTemplate(dataSource);
    }

    @Override
    public Member save(Member member) {
        SimpleJdbcInsert jdbcInsert = new SimpleJdbcInsert(jdbcTemplate);
        jdbcInsert.withTableName("member").usingGeneratedKeyColumns("id");

        Map<String, Object> parameters = new HashMap<>();
        parameters.put("name", member.getName());

        Number key = jdbcInsert.executeAndReturnKey(new MapSqlParameterSource(parameters));
        member.setId(key.longValue());
        return member;
    }

    @Override
    public Optional<Member> findById(Long id) {
        List<Member> result = jdbcTemplate.query(
            "select * from member where id = ?", memberRowMapper(), id);
        return result.stream().findAny();
    }

    @Override
    public Optional<Member> findByName(String name) {
        List<Member> result = jdbcTemplate.query(
            "select * from member where name = ?", memberRowMapper(), name);
        return result.stream().findAny();
    }

    @Override
    public List<Member> findAll() {
        return jdbcTemplate.query("select * from member", memberRowMapper());
    }
    // ...
}
```

### 4.3 RowMapperì™€ ëŒë‹¤ í‘œí˜„ì‹

`RowMapper`ëŠ” `ResultSet`ì˜ ê° í–‰ì„ Java ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

```java
// ìµëª… í´ë˜ìŠ¤ ë°©ì‹ (ì›ë³¸)
private RowMapper<Member> memberRowMapper() {
    return new RowMapper<Member>() {
        @Override
        public Member mapRow(ResultSet rs, int rowNum) throws SQLException {
            Member member = new Member();
            member.setId(rs.getLong("id"));
            member.setName(rs.getString("name"));
            return member;
        }
    };
}

// ëŒë‹¤ ë°©ì‹ (ê°„ì†Œí™”)
private RowMapper<Member> memberRowMapper() {
    return (rs, rowNum) -> {
        Member member = new Member();
        member.setId(rs.getLong("id"));
        member.setName(rs.getString("name"));
        return member;
    };
}
```

**RowMapper ë™ì‘ ì›ë¦¬:**

```
jdbcTemplate.query("select * from member", memberRowMapper())
        â†“
SQL ì‹¤í–‰ â†’ ResultSet (ì—¬ëŸ¬ í–‰)
        â†“
ê° í–‰ë§ˆë‹¤ memberRowMapper() í˜¸ì¶œ
        â†“
rs.getLong("id"), rs.getString("name") â†’ Member ê°ì²´ ìƒì„±
        â†“
List<Member> ë°˜í™˜
```

### 4.4 SimpleJdbcInsertë¡œ INSERT ê°„ì†Œí™”

`SimpleJdbcInsert`ëŠ” í…Œì´ë¸” ë©”íƒ€ë°ì´í„°ë¥¼ ì½ì–´ INSERT SQLì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

```java
SimpleJdbcInsert jdbcInsert = new SimpleJdbcInsert(jdbcTemplate);
jdbcInsert
    .withTableName("member")           // ì–´ë–¤ í…Œì´ë¸”ì—?
    .usingGeneratedKeyColumns("id");   // ì–´ë–¤ ì»¬ëŸ¼ì´ ìë™ ìƒì„± í‚¤?

Map<String, Object> parameters = new HashMap<>();
parameters.put("name", member.getName());  // ì»¬ëŸ¼ëª… â†’ ê°’ ë§¤í•‘

// INSERT INTO member(name) VALUES(?) ë¥¼ ìë™ ìƒì„± ë° ì‹¤í–‰
// ìƒì„±ëœ id ê°’ì„ ìë™ìœ¼ë¡œ ë°˜í™˜
Number key = jdbcInsert.executeAndReturnKey(new MapSqlParameterSource(parameters));
```

---

## 5. JPA

### 5.1 JPAë€? ORM íŒ¨ëŸ¬ë‹¤ì„ ì „í™˜

**JPA(Java Persistence API)** ëŠ” ìë°” ORM ê¸°ìˆ ì˜ í‘œì¤€ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. êµ¬í˜„ì²´ëŠ” ë³´í†µ **Hibernate**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

| ê¸°ì¡´ SQL ë°©ì‹ | JPA(ORM) ë°©ì‹ |
|--------------|--------------|
| SQL ì¤‘ì‹¬ ê°œë°œ | ê°ì²´ ì¤‘ì‹¬ ê°œë°œ |
| ê°œë°œìê°€ SQL ì‘ì„± | JPAê°€ SQL ìë™ ìƒì„± |
| ê°ì²´ì™€ í…Œì´ë¸”ì„ ì§ì ‘ ë§¤í•‘ | `@Entity` ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ì„ ì–¸ì  ë§¤í•‘ |
| ë°˜ë³µì ì¸ CRUD SQL | `persist()`, `find()` ë“± ë©”ì„œë“œ í˜¸ì¶œ |

```
[ORM íŒ¨ëŸ¬ë‹¤ì„]

Java ì½”ë“œ                     DB
Member (ê°ì²´)    â†â”€â”€JPAâ”€â”€â†’   member í…Œì´ë¸” (í–‰)
  id: Long       ë§¤í•‘        id: bigint
  name: String              name: varchar
```

### 5.2 @Entity, @Id, @GeneratedValue ë§¤í•‘

```java
import jakarta.persistence.*;

@Entity  // JPAê°€ ê´€ë¦¬í•˜ëŠ” ì—”í‹°í‹°ë¡œ ì„ ì–¸
public class Member {

    @Id  // ê¸°ë³¸í‚¤(PK) ë§¤í•‘
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    // IDENTITY: DBê°€ idë¥¼ ìë™ ìƒì„± (H2ì˜ 'generated by default as identity'ì™€ ì—°ê²°)
    private Long id;

    // @Column(name = "username")  // DB ì»¬ëŸ¼ëª…ì´ ë‹¤ë¥¼ ë•Œ ì‚¬ìš©
    private String name;  // í•„ë“œëª… = ì»¬ëŸ¼ëª… (ìë™ ë§¤í•‘)

    // getter, setter ...
}
```

| ì–´ë…¸í…Œì´ì…˜ | ì—­í•  |
|-----------|------|
| `@Entity` | ì´ í´ë˜ìŠ¤ê°€ JPA ì—”í‹°í‹°ì„ì„ ì„ ì–¸. DB í…Œì´ë¸”ê³¼ ë§¤í•‘ |
| `@Id` | ì´ í•„ë“œê°€ í…Œì´ë¸”ì˜ ê¸°ë³¸í‚¤(PK)ì„ì„ ì„ ì–¸ |
| `@GeneratedValue(strategy = GenerationType.IDENTITY)` | DBê°€ í‚¤ë¥¼ ìë™ ìƒì„±(AUTO_INCREMENT ë°©ì‹) |
| `@Column(name = "...")` | í•„ë“œëª…ê³¼ ë‹¤ë¥¸ ì»¬ëŸ¼ëª…ì„ ì‚¬ìš©í•  ë•Œ ëª…ì‹œ |

### 5.3 EntityManager - JPAì˜ í•µì‹¬

JPAëŠ” `EntityManager` í•˜ë‚˜ë¡œ ëª¨ë“  ê²ƒì´ ë™ì‘í•©ë‹ˆë‹¤. ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ `application.properties`ë¥¼ ë³´ê³  ìë™ìœ¼ë¡œ ìƒì„±í•´ì¤ë‹ˆë‹¤.

```java
public class JpaMemberRepository implements MemberRepository {

    private final EntityManager em;

    public JpaMemberRepository(EntityManager em) {
        this.em = em;
    }

    @Override
    public Member save(Member member) {
        // persist: "ì˜ì†í™”í•˜ë‹¤" - JPAê°€ INSERT SQL ìë™ ìƒì„± + id ì„¸íŒ…ê¹Œì§€
        em.persist(member);
        return member;
    }

    @Override
    public Optional<Member> findById(Long id) {
        // ê¸°ë³¸í‚¤(PK)ë¡œ ì¡°íšŒ - SELECT SQL ìë™ ìƒì„±
        Member member = em.find(Member.class, id);
        return Optional.ofNullable(member);
    }

    @Override
    public List<Member> findAll() {
        // JPQL: í…Œì´ë¸”ì´ ì•„ë‹Œ ì—”í‹°í‹°(ê°ì²´)ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬
        return em.createQuery("select m from Member m", Member.class)
                 .getResultList();
    }
}
```

**EntityManager ì£¼ìš” ë©”ì„œë“œ:**

| ë©”ì„œë“œ | SQL ìƒë‹¹ | ì„¤ëª… |
|--------|----------|------|
| `em.persist(entity)` | `INSERT` | ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ì–´ ì €ì¥ |
| `em.find(Class, id)` | `SELECT WHERE id=?` | PKë¡œ ì—”í‹°í‹° ì¡°íšŒ |
| `em.createQuery(jpql)` | `SELECT` | JPQL ì¿¼ë¦¬ ì‹¤í–‰ |
| `em.remove(entity)` | `DELETE` | ì—”í‹°í‹° ì‚­ì œ |

### 5.4 JPQL - ê°ì²´ ëŒ€ìƒ ì¿¼ë¦¬

JPQLì€ **í…Œì´ë¸”ì´ ì•„ë‹Œ ì—”í‹°í‹°(ê°ì²´)ë¥¼ ëŒ€ìƒìœ¼ë¡œ** ì¿¼ë¦¬ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

```java
// PK ê¸°ë°˜ì´ ì•„ë‹Œ ì¡°íšŒëŠ” JPQL í•„ìš”
@Override
public Optional<Member> findByName(String name) {
    List<Member> result = em.createQuery(
            "select m from Member m where m.name = :name", Member.class)
        .setParameter("name", name)
        .getResultList();
    return result.stream().findAny();
}
```

**SQL vs JPQL ë¹„êµ:**

```sql
-- ì¼ë°˜ SQL: í…Œì´ë¸” ëŒ€ìƒ
SELECT * FROM member WHERE name = 'spring'

-- JPQL: ì—”í‹°í‹°(ê°ì²´) ëŒ€ìƒ (JPAê°€ SQLë¡œ ë²ˆì—­)
select m from Member m where m.name = :name
--     â†‘         â†‘                    â†‘
--  ë³„ì¹­   ì—”í‹°í‹° í´ë˜ìŠ¤ëª…        íŒŒë¼ë¯¸í„° ë°”ì¸ë”©
```

### 5.5 @Transactional - JPA í•„ìˆ˜ ì¡°ê±´

JPAë¥¼ í†µí•œ ëª¨ë“  ë°ì´í„° ë³€ê²½ì€ **ë°˜ë“œì‹œ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ** ì‹¤í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

```java
// MemberServiceì— @Transactional ì ìš©
import org.springframework.transaction.annotation.Transactional;

@Transactional  // í´ë˜ìŠ¤ ë ˆë²¨ì— ë¶™ì´ë©´ ëª¨ë“  ë©”ì„œë“œì— ì ìš©
public class MemberService {

    public Long join(Member member) {  // íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì‹¤í–‰ë¨
        validateDuplicateMember(member);
        memberRepository.save(member);  // JPA persist â†’ DBì— ë°˜ì˜
        return member.getId();
    }
}
```

### 5.6 SpringConfig ë³€ê²½

```java
@Configuration
public class SpringConfig {

    private EntityManager em;

    @Autowired
    public SpringConfig(EntityManager em) {
        this.em = em;
    }

    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository());
    }

    @Bean
    public MemberRepository memberRepository() {
        // return new JdbcTemplateMemberRepository(dataSource);  // ì´ì „
        return new JpaMemberRepository(em);  // êµì²´!
    }
}
```

---

## 6. ìŠ¤í”„ë§ ë°ì´í„° JPA

### 6.1 ì¸í„°í˜ì´ìŠ¤ë§Œìœ¼ë¡œ êµ¬í˜„ ì™„ì„±

ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” JPAë¥¼ í•œ ë²ˆ ë” ê°ì‹¸ì„œ, **ì¸í„°í˜ì´ìŠ¤ ì„ ì–¸ë§Œìœ¼ë¡œ** êµ¬í˜„ì²´ë¥¼ ìë™ ìƒì„±í•´ì¤ë‹ˆë‹¤.

```java
// interfaceê°€ interfaceë¥¼ ë°›ì„ ë•ŒëŠ” extends
// interfaceëŠ” ë‹¤ì¤‘ ìƒì† ê°€ëŠ¥
public interface SpringDataJpaMemberRepository
        extends JpaRepository<Member, Long>, MemberRepository {

    // findByName â†’ JPQL: select m from Member m where m.name = ?
    // ë©”ì„œë“œ ì´ë¦„ ê·œì¹™ìœ¼ë¡œ ì¿¼ë¦¬ ìë™ ìƒì„±!
    @Override
    Optional<Member> findByName(String name);
}
```

**í•µì‹¬ ë™ì‘ ì›ë¦¬:**

```
SpringDataJpaMemberRepository (ì¸í„°í˜ì´ìŠ¤)
        â†“
ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ëŸ°íƒ€ì„ì— êµ¬í˜„ì²´ ìë™ ìƒì„±
        â†“
ìŠ¤í”„ë§ ë¹ˆì— ìë™ ë“±ë¡
        â†“
SpringConfigì—ì„œ ì£¼ì…ë°›ì•„ ì‚¬ìš©
```

### 6.2 ë©”ì„œë“œ ì´ë¦„ ì¿¼ë¦¬ ìë™ ìƒì„± ì›ë¦¬

ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ë©”ì„œë“œ ì´ë¦„ì„ **ë¦¬í”Œë ‰ì…˜(Reflection)** ê¸°ìˆ ë¡œ ë¶„ì„í•˜ì—¬ JPQLì„ ìë™ ìƒì„±í•©ë‹ˆë‹¤.

| ë©”ì„œë“œ ì´ë¦„ | ìë™ ìƒì„± JPQL |
|------------|--------------|
| `findByName(String name)` | `select m from Member m where m.name = ?` |
| `findByNameAndId(String name, Long id)` | `select m from Member m where m.name = ? and m.id = ?` |
| `findByNameContaining(String name)` | `select m from Member m where m.name like %?%` |
| `countByName(String name)` | `select count(m) from Member m where m.name = ?` |

> ê·œì¹™: `findBy`, `countBy`, `deleteBy` + í•„ë“œëª… + ì¡°ê±´(And, Or, Containing, GreaterThan, ...)

### 6.3 JpaRepository ì œê³µ ê¸°ëŠ¥ ê³„ì¸µë„

```
[JpaRepository ìƒì† ê³„ì¸µ]

JpaRepository<Member, Long>
        â†‘ ìƒì†
PagingAndSortingRepository  â†’ findAll(Sort), findAll(Pageable)
        â†‘ ìƒì†
CrudRepository              â†’ save(), findById(), findAll(), count(), delete()
        â†‘ ìƒì†
Repository                  (ë§ˆì»¤ ì¸í„°í˜ì´ìŠ¤)
```

| ì œê³µ ë©”ì„œë“œ | ì„¤ëª… |
|------------|------|
| `save(entity)` | ì €ì¥ (ì—†ìœ¼ë©´ INSERT, ìˆìœ¼ë©´ UPDATE) |
| `findById(id)` | PKë¡œ ì¡°íšŒ |
| `findAll()` | ì „ì²´ ì¡°íšŒ |
| `count()` | ê°œìˆ˜ ì¡°íšŒ |
| `delete(entity)` | ì‚­ì œ |
| `findAll(Sort)` | ì •ë ¬í•´ì„œ ì „ì²´ ì¡°íšŒ |
| `findAll(Pageable)` | í˜ì´ì§• ì¡°íšŒ |

### 6.4 SpringConfig ë³€ê²½ - DI ìµœì¢… í˜•íƒœ

ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” êµ¬í˜„ì²´ë¥¼ ìë™ ìƒì„±í•˜ì—¬ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•©ë‹ˆë‹¤. ë”°ë¼ì„œ `SpringConfig`ì—ì„œ ê·¸ëƒ¥ ì£¼ì…ë°›ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.

```java
@Configuration
public class SpringConfig {

    // ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ìë™ìœ¼ë¡œ ë§Œë“  êµ¬í˜„ì²´ê°€ ì£¼ì…ëœë‹¤
    private final MemberRepository memberRepository;

    @Autowired
    public SpringConfig(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository);
    }

    // @Bean MemberRepository ë¶ˆí•„ìš”! ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì•Œì•„ì„œ ë“±ë¡
}
```

**DI íë¦„:**

```
SpringDataJpaMemberRepository (interface)
        â†“
ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ êµ¬í˜„ì²´ ìë™ ìƒì„± + ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡
        â†“
SpringConfig ìƒì„±ìì— MemberRepository íƒ€ì…ìœ¼ë¡œ ìë™ ì£¼ì…
        â†“
MemberService(memberRepository) ìƒì„±
        â†“
MemberController â†’ MemberService â†’ SpringDataJpaMemberRepository â†’ H2 DB
```

---

## 7. DB ì ‘ê·¼ ê¸°ìˆ  ì§„í™” ë¹„êµ

| ê¸°ìˆ  | ì½”ë“œ ì–‘ | SQL ì‘ì„± | ì—°ê²° ê´€ë¦¬ | íŠ¹ì§• |
|------|--------|---------|---------|------|
| **ë©”ëª¨ë¦¬** | ìµœì†Œ | ë¶ˆí•„ìš” | ë¶ˆí•„ìš” | ì„œë²„ ì¬ì‹œì‘ ì‹œ ë°ì´í„° ì†Œë©¸ |
| **ìˆœìˆ˜ JDBC** | ~200ì¤„ | ì§ì ‘ ì‘ì„± | ì§ì ‘ ê´€ë¦¬ | ìë°” í‘œì¤€, ì›ë¦¬ ì´í•´ì— ì¤‘ìš” |
| **JdbcTemplate** | ~50ì¤„ | ì§ì ‘ ì‘ì„± | ìë™ | ë°˜ë³µ ì½”ë“œ ì œê±°, ì‹¤ë¬´ ì‚¬ìš© |
| **JPA** | ~20ì¤„ | JPQL | ìë™ | ORM, ê°ì²´ ì¤‘ì‹¬ ê°œë°œ |
| **Spring Data JPA** | ~3ì¤„ | ìë™ ìƒì„± | ìë™ | ì¸í„°í˜ì´ìŠ¤ë§Œìœ¼ë¡œ ì™„ì„± |

**êµ¬í˜„ì²´ êµì²´ ë°©ë²• ë¹„êµ:**

```
[ìˆœìˆ˜ JDBC]
return new JdbcMemberRepository(dataSource);

[JdbcTemplate]
return new JdbcTemplateMemberRepository(dataSource);

[JPA]
return new JpaMemberRepository(em);

[Spring Data JPA]
// @Bean ìì²´ê°€ ë¶ˆí•„ìš” - ìë™ ì£¼ì…
private final MemberRepository memberRepository;
```

**ê³µí†µì **: `MemberService`, `MemberController` ë“± í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” ë‹¨ í•œ ì¤„ë„ ë³€ê²½ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

---

## 8. Best Practice ë° ì•ˆí‹°íŒ¨í„´

### 8.1 DataSourceUtilsë¥¼ í†µí•œ ì»¤ë„¥ì…˜ ê´€ë¦¬

**âœ… ê¶Œì¥: DataSourceUtils ê²½ìœ **

```java
// ìŠ¤í”„ë§ íŠ¸ëœì­ì…˜ê³¼ ì—°ë™ë˜ì–´ ê°™ì€ ì»¤ë„¥ì…˜ ì¬ì‚¬ìš©
private Connection getConnection() {
    return DataSourceUtils.getConnection(dataSource);
}

private void close(Connection conn) throws SQLException {
    DataSourceUtils.releaseConnection(conn, dataSource);
}
```

**âŒ ì•ˆí‹°íŒ¨í„´: DataSourceì—ì„œ ì§ì ‘ íšë“**

```java
// íŠ¸ëœì­ì…˜ê³¼ ë¬´ê´€í•œ ìƒˆ ì»¤ë„¥ì…˜ì´ ìƒì„±ë¨
private Connection getConnection() throws SQLException {
    return dataSource.getConnection();  // íŠ¸ëœì­ì…˜ ì—°ë™ ë¶ˆê°€!
}
```

### 8.2 @Transactional ìœ„ì¹˜

**âœ… ê¶Œì¥: ì„œë¹„ìŠ¤ ë ˆì´ì–´ì— ì„ ì–¸**

```java
@Transactional  // ì„œë¹„ìŠ¤ ë ˆì´ì–´ì— ì„ ì–¸
public class MemberService {
    public Long join(Member member) {
        // JPA ë³€ê²½ ì‘ì—…ì´ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì‹¤í–‰ë¨
        memberRepository.save(member);
        return member.getId();
    }
}
```

**âŒ ì•ˆí‹°íŒ¨í„´: íŠ¸ëœì­ì…˜ ì—†ì´ JPA ì‚¬ìš©**

```java
// @Transactional ì—†ì´ JPA persist í˜¸ì¶œ â†’ ì˜ˆì™¸ ë°œìƒ!
public Long join(Member member) {
    memberRepository.save(member);  // TransactionRequiredException!
    return member.getId();
}
```

### 8.3 Spring Data JPA - ê³µí†µ ë©”ì„œë“œ vs ì»¤ìŠ¤í…€ ë©”ì„œë“œ

**âœ… ê¶Œì¥: ê¸°ë³¸ ì œê³µ ë©”ì„œë“œ í™œìš©**

```java
public interface SpringDataJpaMemberRepository
        extends JpaRepository<Member, Long>, MemberRepository {

    // save(), findById(), findAll() ë“±ì€ ì´ë¯¸ JpaRepositoryê°€ ì œê³µ
    // â†’ ë”°ë¡œ ì„ ì–¸ ë¶ˆí•„ìš”

    // ê³µí†µí™”í•  ìˆ˜ ì—†ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ê³ ìœ  ì¿¼ë¦¬ë§Œ ì„ ì–¸
    Optional<Member> findByName(String name);
}
```

**âŒ ì•ˆí‹°íŒ¨í„´: ì´ë¯¸ ìˆëŠ” ë©”ì„œë“œë¥¼ ì¤‘ë³µ ì„ ì–¸**

```java
public interface SpringDataJpaMemberRepository
        extends JpaRepository<Member, Long>, MemberRepository {

    // findAll()ì€ JpaRepositoryê°€ ì´ë¯¸ ì œê³µ - ì¤‘ë³µ ì„ ì–¸ ë¶ˆí•„ìš”
    List<Member> findAll();  // âŒ ë¶ˆí•„ìš”
    Optional<Member> findById(Long id);  // âŒ ë¶ˆí•„ìš”
}
```

### 8.4 í†µí•© í…ŒìŠ¤íŠ¸ vs ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

**âœ… ê¶Œì¥: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìš°ì„  ì‘ì„±**

```java
// ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì—†ì´ ë¹ ë¥´ê²Œ ì‹¤í–‰ - ì„¤ê³„ê°€ ì˜ ëœ ì½”ë“œ
class MemberServiceTest {
    MemberService memberService;
    MemoryMemberRepository memberRepository;

    @BeforeEach
    public void beforeEach() {
        memberRepository = new MemoryMemberRepository();
        memberService = new MemberService(memberRepository);
    }
}
```

**âš ï¸ ì£¼ì˜: í†µí•© í…ŒìŠ¤íŠ¸ëŠ” í•„ìš”í•  ë•Œë§Œ**

```java
// ì»¨í…Œì´ë„ˆë¥¼ ë„ìš°ë¯€ë¡œ ëŠë¦¬ë‹¤. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¡œ ì»¤ë²„ ì•ˆë˜ëŠ” ê²½ìš°ì—ë§Œ ì‚¬ìš©
@SpringBootTest
@Transactional
class MemberServiceIntegrationTest {
    @Autowired MemberService memberService;
    @Autowired MemberRepository memberRepository;
}
```

### 8.5 ì¢…í•© ì •ë¦¬í‘œ

| ìƒí™© | âœ… ê¶Œì¥ | âŒ ì•ˆí‹°íŒ¨í„´ |
|------|---------|------------|
| ì»¤ë„¥ì…˜ íšë“ | `DataSourceUtils.getConnection()` | `dataSource.getConnection()` ì§ì ‘ í˜¸ì¶œ |
| JPA ë³€ê²½ ì‘ì—… | `@Transactional` í•„ìˆ˜ | íŠ¸ëœì­ì…˜ ì—†ì´ `em.persist()` |
| í…ŒìŠ¤íŠ¸ í›„ DB ì •ë¦¬ | `@Transactional`ë¡œ ìë™ ë¡¤ë°± | ì§ì ‘ DELETE ì¿¼ë¦¬ ì‹¤í–‰ |
| Spring Data JPA ì»¤ìŠ¤í…€ ì¿¼ë¦¬ | ë©”ì„œë“œ ì´ë¦„ ê·œì¹™ í™œìš© | ëª¨ë“  ë©”ì„œë“œ ì§ì ‘ êµ¬í˜„ |
| êµ¬í˜„ì²´ êµì²´ | `SpringConfig` @Bean ë°˜í™˜ê°’ë§Œ ë³€ê²½ | í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ì „ì²´ ìˆ˜ì • |

---

## 9. ë¶€ë¡

### 9.1 í”„ë¡œì íŠ¸ êµ¬ì¡° (ë³€ê²½ ì‚¬í•­)

```
hello-spring/
â”œâ”€â”€ build.gradle                        â† data-jpa, h2 ì˜ì¡´ì„± ì¶”ê°€
â”œâ”€â”€ sql/
â”‚   â””â”€â”€ ddl.sql                         â† ì´ë²ˆ ê°•ì˜ ì¶”ê°€ (í…Œì´ë¸” DDL)
â””â”€â”€ src/
    â”œâ”€â”€ main/
    â”‚   â”œâ”€â”€ java/
    â”‚   â”‚   â””â”€â”€ hello/
    â”‚   â”‚       â””â”€â”€ hello_spring/
    â”‚   â”‚           â”œâ”€â”€ SpringConfig.java        â† êµ¬í˜„ì²´ êµì²´ (ë°˜ë³µ)
    â”‚   â”‚           â”œâ”€â”€ domain/
    â”‚   â”‚           â”‚   â””â”€â”€ Member.java          â† @Entity, @Id, @GeneratedValue ì¶”ê°€
    â”‚   â”‚           â”œâ”€â”€ repository/
    â”‚   â”‚           â”‚   â”œâ”€â”€ MemberRepository.java             (ì¸í„°í˜ì´ìŠ¤, ë³€ê²½ ì—†ìŒ)
    â”‚   â”‚           â”‚   â”œâ”€â”€ MemoryMemberRepository.java       (ê¸°ì¡´)
    â”‚   â”‚           â”‚   â”œâ”€â”€ JdbcMemberRepository.java         â† ì´ë²ˆ ê°•ì˜ ì¶”ê°€
    â”‚   â”‚           â”‚   â”œâ”€â”€ JdbcTemplateMemberRepository.java â† ì´ë²ˆ ê°•ì˜ ì¶”ê°€
    â”‚   â”‚           â”‚   â”œâ”€â”€ JpaMemberRepository.java          â† ì´ë²ˆ ê°•ì˜ ì¶”ê°€
    â”‚   â”‚           â”‚   â””â”€â”€ SpringDataJpaMemberRepository.javaâ† ì´ë²ˆ ê°•ì˜ ì¶”ê°€
    â”‚   â”‚           â””â”€â”€ service/
    â”‚   â”‚               â””â”€â”€ MemberService.java   â† @Transactional ì¶”ê°€
    â”‚   â””â”€â”€ resources/
    â”‚       â””â”€â”€ application.properties  â† datasource, jpa ì„¤ì • ì¶”ê°€
    â””â”€â”€ test/
        â””â”€â”€ java/
            â””â”€â”€ hello/
                â””â”€â”€ hello_spring/
                    â””â”€â”€ service/
                        â””â”€â”€ MemberServiceIntegrationTest.java â† ì´ë²ˆ ê°•ì˜ ì¶”ê°€
```

### 9.2 í•µì‹¬ ìš©ì–´ ì •ë¦¬

| ìš©ì–´ | ì„¤ëª… |
|------|------|
| **JDBC** | Java Database Connectivity. ìë°”ì—ì„œ DBì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ í‘œì¤€ API |
| **DataSource** | DB ì»¤ë„¥ì…˜ í’€ì„ ê´€ë¦¬í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤. ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ìë™ ìƒì„± |
| **DataSourceUtils** | ìŠ¤í”„ë§ íŠ¸ëœì­ì…˜ê³¼ ì—°ë™ëœ ì»¤ë„¥ì…˜ íšë“/ë°˜í™˜ ìœ í‹¸ë¦¬í‹° |
| **Connection Pool** | DB ì»¤ë„¥ì…˜ì„ ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘ê³  ì¬ì‚¬ìš©í•˜ëŠ” ê¸°ë²• |
| **ORM** | Object-Relational Mapping. ê°ì²´ì™€ DB í…Œì´ë¸”ì„ ìë™ìœ¼ë¡œ ë§¤í•‘ |
| **JPA** | Java Persistence API. ìë°” ORM í‘œì¤€ ì¸í„°í˜ì´ìŠ¤ |
| **Hibernate** | JPAì˜ ëŒ€í‘œì ì¸ êµ¬í˜„ì²´ |
| **EntityManager** | JPA ì‘ì—…ì˜ í•µì‹¬ ì¸í„°í˜ì´ìŠ¤. ì—”í‹°í‹°ì˜ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬ |
| **JPQL** | JPA ì¿¼ë¦¬ ì–¸ì–´. í…Œì´ë¸” ëŒ€ì‹  ì—”í‹°í‹°(ê°ì²´)ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬ |
| **Spring Data JPA** | JPAë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ë„ë¡ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ì¶”ìƒí™” ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| **@Transactional** | íŠ¸ëœì­ì…˜ ê²½ê³„ë¥¼ ì„ ì–¸í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ |
| **OCP** | Open-Closed Principle. í™•ì¥ì—ëŠ” ì—´ë ¤ ìˆê³  ë³€ê²½ì—ëŠ” ë‹«í˜€ ìˆì–´ì•¼ í•œë‹¤ |
| **RowMapper** | ResultSetì˜ ê° í–‰ì„ Java ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ |
| **SimpleJdbcInsert** | INSERT SQLì„ ìë™ ìƒì„±í•´ì£¼ëŠ” JdbcTemplate í—¬í¼ í´ë˜ìŠ¤ |

### 9.3 ì–´ë…¸í…Œì´ì…˜ ì •ë¦¬

| ì–´ë…¸í…Œì´ì…˜ | ìœ„ì¹˜ | ì—­í•  |
|-----------|------|------|
| `@Entity` | í´ë˜ìŠ¤ | JPA ì—”í‹°í‹° ì„ ì–¸. DB í…Œì´ë¸”ê³¼ ë§¤í•‘ |
| `@Id` | í•„ë“œ | ê¸°ë³¸í‚¤(PK) ë§¤í•‘ |
| `@GeneratedValue(strategy = GenerationType.IDENTITY)` | í•„ë“œ | DB ìë™ ì¦ê°€ í‚¤ ìƒì„± ì „ëµ |
| `@Column(name = "...")` | í•„ë“œ | ì»¬ëŸ¼ëª…ì´ í•„ë“œëª…ê³¼ ë‹¤ë¥¼ ë•Œ ëª…ì‹œ |
| `@Transactional` | í´ë˜ìŠ¤/ë©”ì„œë“œ | íŠ¸ëœì­ì…˜ ê²½ê³„ ì„ ì–¸. JPA ë³€ê²½ ì‘ì—…ì— í•„ìˆ˜ |
| `@SpringBootTest` | í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ | ì‹¤ì œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ë„ì›Œ í†µí•© í…ŒìŠ¤íŠ¸ |
| `@Commit` | í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ | `@Transactional` í…ŒìŠ¤íŠ¸ì—ì„œ ë¡¤ë°± ëŒ€ì‹  ì»¤ë°‹ |
| `@Autowired` | í•„ë“œ/ìƒì„±ì | ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ë¹ˆ ìë™ ì£¼ì… |
| `@Configuration` | í´ë˜ìŠ¤ | ì„¤ì • íŒŒì¼ì„ì„ ì„ ì–¸. `@Bean` ë©”ì„œë“œ í¬í•¨ |
| `@Bean` | ë©”ì„œë“œ | ë°˜í™˜ ê°ì²´ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ |

### 9.4 í•™ìŠµ ì ê²€ (Q&A)

ë‹¤ìŒ ì§ˆë¬¸ì— ë‹µí•˜ë©° í•™ìŠµ ë‚´ìš©ì„ í™•ì¸í•´ë³´ì„¸ìš”:

1. **ìˆœìˆ˜ JDBCì—ì„œ `DataSourceUtils.getConnection()`ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ”?**
   - ìŠ¤í”„ë§ íŠ¸ëœì­ì…˜ê³¼ ì—°ë™í•˜ì—¬ ê°™ì€ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ë™ì¼í•œ ì»¤ë„¥ì…˜ì„ ì¬ì‚¬ìš©í•˜ê¸° ìœ„í•´

2. **`SpringConfig`ì—ì„œ êµ¬í˜„ì²´ë¥¼ êµì²´í•  ë•Œ `MemberService`ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šì•„ë„ ë˜ëŠ” ì´ìœ ëŠ”?**
   - `MemberService`ëŠ” `MemberRepository` ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ê¸° ë•Œë¬¸ì—. DIì™€ OCPì˜ ê²°í•©

3. **`@Transactional`ì´ ì„œë¹„ìŠ¤ì— ë¶™ì„ ë•Œì™€ í…ŒìŠ¤íŠ¸ì— ë¶™ì„ ë•Œ ë™ì‘ì´ ë‹¤ë¥¸ ì´ìœ ëŠ”?**
   - ì„œë¹„ìŠ¤ì—ì„œëŠ” ì •ìƒ ë™ì‘ í›„ ì»¤ë°‹, í…ŒìŠ¤íŠ¸ì—ì„œëŠ” í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„ ìë™ ë¡¤ë°±í•˜ì—¬ DBë¥¼ ì´ˆê¸° ìƒíƒœë¡œ ë³µì›

4. **JdbcTemplateì˜ `RowMapper`ê°€ í•˜ëŠ” ì—­í• ì€?**
   - `ResultSet`ì˜ ê° í–‰(row)ì„ Java ê°ì²´(`Member`)ë¡œ ë³€í™˜í•˜ëŠ” ë§¤í•‘ í•¨ìˆ˜

5. **JPAì—ì„œ PK ì¡°íšŒì™€ ë¹„PK ì¡°íšŒì˜ ì°¨ì´ëŠ”?**
   - PK ì¡°íšŒ: `em.find(Member.class, id)` - SQL ìë™ ìƒì„±. ë¹„PK ì¡°íšŒ: `em.createQuery(JPQL)` - JPQL ì§ì ‘ ì‘ì„± í•„ìš”

6. **Spring Data JPAì—ì„œ `findByName(String name)` ë©”ì„œë“œë¥¼ ì„ ì–¸ë§Œ í•´ë„ ë™ì‘í•˜ëŠ” ì´ìœ ëŠ”?**
   - ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ë©”ì„œë“œ ì´ë¦„ì„ ë¦¬í”Œë ‰ì…˜ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ JPQL(`select m from Member m where m.name = ?`)ì„ ìë™ ìƒì„±í•˜ê³  êµ¬í˜„ì²´ë¥¼ ëŸ°íƒ€ì„ì— ë§Œë“¤ê¸° ë•Œë¬¸

7. **ì™œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ í†µí•© í…ŒìŠ¤íŠ¸ë³´ë‹¤ ìš°ì„ ì ìœ¼ë¡œ ê¶Œì¥ë˜ëŠ”ê°€?**
   - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì—†ì´ ë¹ ë¥´ê²Œ ì‹¤í–‰ë˜ê³ , ì„¤ê³„ê°€ ì˜ ëœ ì½”ë“œì¼ìˆ˜ë¡ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¡œ ì¶©ë¶„íˆ ì»¤ë²„ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸

### 9.5 ë‹¤ìŒ í•™ìŠµ ë‹¨ê³„ (AOP)

ì´ë²ˆ ì±•í„°ì—ì„œ êµ¬í˜„í•œ `MemberService`ë¥¼ ì‚´í´ë³´ë©´, ê° ë©”ì„œë“œë§ˆë‹¤ ì‹œê°„ ì¸¡ì • ê°™ì€ **ê³µí†µ ê´€ì‹¬ì‚¬(Cross-cutting Concern)** ì½”ë“œë¥¼ ì¶”ê°€í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ ìƒê¹ë‹ˆë‹¤.

```
í˜„ì¬ ìƒíƒœ:
MemberController â†’ MemberService â†’ SpringDataJpaMemberRepository â†’ H2 DB

ë¬¸ì œ: ëª¨ë“  ë©”ì„œë“œ ì‹¤í–‰ ì‹œê°„ì„ ì¸¡ì •í•˜ë ¤ë©´?

void join() {
    long start = System.currentTimeMillis();  // â† ê³µí†µ ì½”ë“œ
    try {
        ...ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§...
    } finally {
        long end = System.currentTimeMillis();  // â† ê³µí†µ ì½”ë“œ
        System.out.println("ì‹¤í–‰ ì‹œê°„: " + (end - start) + "ms");
    }
}
// â†’ ëª¨ë“  ë©”ì„œë“œì— ë™ì¼í•œ ì½”ë“œë¥¼ ë°˜ë³µí•´ì•¼ í•œë‹¤. ìœ ì§€ë³´ìˆ˜ ë¶ˆê°€ëŠ¥!
```

**ë‹¤ìŒ ëª©í‘œ: AOP(Aspect-Oriented Programming)**

```
AOP ì ìš© í›„:

[ê³µí†µ ê´€ì‹¬ì‚¬ - TimeTraceAop]     [í•µì‹¬ ê´€ì‹¬ì‚¬ - MemberService]
  ì‹œì‘ ì‹œê°„ ì¸¡ì •          â†’      join() ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
  ë ì‹œê°„ ì¸¡ì •            â†      findMembers() ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
  ë¡œê·¸ ì¶œë ¥
```

ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ë°°ìš¸ ë‚´ìš©:
- **AOP**: ê³µí†µ ê´€ì‹¬ì‚¬(ë¡œê¹…, ì‹œê°„ ì¸¡ì •, íŠ¸ëœì­ì…˜)ë¥¼ í•µì‹¬ ë¡œì§ì—ì„œ ë¶„ë¦¬í•˜ëŠ” ê¸°ë²•
- **@Aspect, @Around**: AOPë¥¼ êµ¬í˜„í•˜ëŠ” ìŠ¤í”„ë§ ì–´ë…¸í…Œì´ì…˜
- **í”„ë¡ì‹œ(Proxy)**: AOPê°€ ë‚´ë¶€ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì›ë¦¬

---

*ì‘ì„±ì¼: 2026-02-22*
*ê°•ì˜: ì¸í”„ëŸ° - ê¹€ì˜í•œì˜ ìŠ¤í”„ë§ ì…ë¬¸*
