# ë„ë©”ì¸ ë¶„ì„ ì„¤ê³„

> ìš”êµ¬ì‚¬í•­ ë¶„ì„ë¶€í„° ì—”í‹°í‹° í´ë˜ìŠ¤ êµ¬í˜„ê¹Œì§€ â€” ì‹¤ì „ ì‡¼í•‘ëª° ë„ë©”ì¸ì„ ì„¤ê³„í•˜ê³  ì½”ë“œë¡œ ì™„ì„±í•˜ëŠ” ë²•

## ğŸ“š ê°•ì˜ ì¶œì²˜

**ì¸í”„ëŸ° - ê¹€ì˜í•œì˜ "ì‹¤ì „! ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ JPA í™œìš© 1 - ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ"**

ì´ ë¬¸ì„œëŠ” ê°•ì˜ì˜ ë‘ ë²ˆì§¸ ì±•í„°ì¸ "ë„ë©”ì¸ ë¶„ì„ ì„¤ê³„"ë¥¼ í•™ìŠµí•˜ë©° ì‘ì„±í•œ ë…¸íŠ¸ì…ë‹ˆë‹¤. í”„ë¡œì íŠ¸ í™˜ê²½ì´ ì¤€ë¹„ëœ í›„, ë³¸ê²©ì ìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ì „ì— **"ë¬´ì—‡ì„ ë§Œë“¤ì§€"ì™€ "ì–´ë–»ê²Œ êµ¬ì¡°ë¥¼ ì¡ì„ì§€"** ë¥¼ ì„¤ê³„í•˜ëŠ” ë‹¨ê³„ë¶€í„° ì‹œì‘í•˜ì—¬, ì„¤ê³„í•œ ë‚´ìš©ì„ ì‹¤ì œ ì—”í‹°í‹° í´ë˜ìŠ¤ë¡œ êµ¬í˜„í•˜ê³ , êµ¬í˜„ ì‹œ ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•  ì£¼ì˜ì ê¹Œì§€ ì „ì²´ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.

**ì´ì „ ì±•í„°(01)ì™€ ì´ ì±•í„°(02)ì˜ ê´€ê³„:**

| í•­ëª© | 01 - í”„ë¡œì íŠ¸ í™˜ê²½ì„¤ì • | 02 - ë„ë©”ì¸ ë¶„ì„ ì„¤ê³„ |
|------|----------------------|---------------------|
| **ëª©í‘œ** | ê°œë°œ í™˜ê²½ êµ¬ì„± | ì„¤ê³„ë„ ì‘ì„± + ì—”í‹°í‹° êµ¬í˜„ |
| **í•µì‹¬ ì§ˆë¬¸** | "ì–´ë–»ê²Œ ì‹¤í–‰í•˜ëŠ”ê°€?" | "ë¬´ì—‡ì„ ì–´ë–»ê²Œ ë§Œë“¤ ê²ƒì¸ê°€?" |
| **ê²°ê³¼ë¬¼** | ë™ì‘í•˜ëŠ” ë¹ˆ í”„ë¡œì íŠ¸ | ë„ë©”ì¸ ëª¨ë¸, í…Œì´ë¸” ì„¤ê³„, ì—°ê´€ê´€ê³„ ë¶„ì„, ì—”í‹°í‹° í´ë˜ìŠ¤ êµ¬í˜„ |
| **ë‹¤ìŒ ë‹¨ê³„** | ë„ë©”ì¸ ì„¤ê³„ | ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬í˜„ ì¤€ë¹„ |

---

## ğŸ¯ í•™ìŠµ ëª©í‘œ

ì´ ë¬¸ì„œë¥¼ í†µí•´ ë‹¤ìŒì„ ì´í•´í•©ë‹ˆë‹¤:

1. **ìš”êµ¬ì‚¬í•­ ë¶„ì„**
   - ì‡¼í•‘ëª° ê¸°ëŠ¥ì„ íšŒì›/ìƒí’ˆ/ì£¼ë¬¸ìœ¼ë¡œ ë¶„ë¥˜
   - ê° ê¸°ëŠ¥ì˜ ë„ë©”ì¸ ìš”ì†Œ(ì—”í‹°í‹° í›„ë³´) ë„ì¶œ

2. **ë„ë©”ì¸ ëª¨ë¸ ì„¤ê³„**
   - í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨(UML)ìœ¼ë¡œ ê°ì²´ ê°„ ê´€ê³„ í‘œí˜„
   - ìƒì† ê´€ê³„(Item â†’ Book/Album/Movie) ì„¤ê³„

3. **í…Œì´ë¸” ì„¤ê³„ (ERD)**
   - ê°ì²´ ëª¨ë¸ì„ ê´€ê³„í˜• DB í…Œì´ë¸”ë¡œ ë³€í™˜
   - ì™¸ë˜ í‚¤(FK) ìœ„ì¹˜ì™€ ì¡°ì¸ í…Œì´ë¸” ê²°ì •

4. **ì—°ê´€ê´€ê³„ ë§¤í•‘ ë¶„ì„**
   - ì—°ê´€ê´€ê³„ ì£¼ì¸(Owner) ê°œë… ì´í•´
   - ê° ê´€ê³„ì—ì„œ ì–´ëŠ ìª½ì´ FKë¥¼ ê°–ëŠ”ì§€ ë¶„ì„

5. **ì„¤ê³„ ì‹œ í•µì‹¬ ì£¼ì˜ì **
   - `@ManyToMany`ë¥¼ ì§€ì–‘í•´ì•¼ í•˜ëŠ” ì´ìœ 
   - ê°’ íƒ€ì…(`@Embeddable`)ê³¼ ì—”í‹°í‹° íƒ€ì…ì˜ ì°¨ì´
   - ë‹¨ë°©í–¥ vs ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì„ íƒ ê¸°ì¤€

6. **ì—”í‹°í‹° í´ë˜ìŠ¤ êµ¬í˜„**
   - ì„¤ê³„í•œ ë„ë©”ì¸ ëª¨ë¸ì„ ì‹¤ì œ Java ì½”ë“œë¡œ ì‘ì„±
   - JPA ì–´ë…¸í…Œì´ì…˜ì„ í™œìš©í•œ ë§¤í•‘ êµ¬í˜„ (`@Entity`, `@Embedded`, `@Inheritance` ë“±)

7. **ì—”í‹°í‹° ì„¤ê³„ ì‹œ êµ¬í˜„ ì£¼ì˜ì **
   - ëª¨ë“  ì—°ê´€ê´€ê³„ë¥¼ LAZY ë¡œë”©ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ì´ìœ 
   - Cascade, ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ, ì»¬ë ‰ì…˜ ì´ˆê¸°í™” ì›ì¹™

---

## ğŸ—ºï¸ í•™ìŠµ ë¡œë“œë§µ

ì´ ë¬¸ì„œëŠ” **ì„¤ê³„ 4ë‹¨ê³„ â†’ êµ¬í˜„ 2ë‹¨ê³„**ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```
1. ìš”êµ¬ì‚¬í•­ ë¶„ì„
   - íšŒì›/ìƒí’ˆ/ì£¼ë¬¸ ê¸°ëŠ¥ ë‚˜ì—´
   - ë„ë©”ì¸ ìš”ì†Œ(ì—”í‹°í‹° í›„ë³´) ì¶”ì¶œ
   â†“
2. ë„ë©”ì¸ ëª¨ë¸ ì„¤ê³„
   - í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨(ê°ì²´ ê´€ì )
   - ìƒì† êµ¬ì¡°, ê°’ íƒ€ì… ì •ì˜
   â†“
3. í…Œì´ë¸” ì„¤ê³„ (ERD)
   - ê°ì²´ â†’ í…Œì´ë¸” ë³€í™˜
   - FK ìœ„ì¹˜, ì¡°ì¸ í…Œì´ë¸” ê²°ì •
   â†“
4. ì—°ê´€ê´€ê³„ ë§¤í•‘ ë¶„ì„
   - ì—°ê´€ê´€ê³„ ì£¼ì¸ ê²°ì •
   - ë‹¨ë°©í–¥/ì–‘ë°©í–¥ ì„ íƒ
   - ê° ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜ ì •ë¦¬
   â†“
5. ì—”í‹°í‹° í´ë˜ìŠ¤ êµ¬í˜„
   - Address, Enum, Member, Item ë“± 12ê°œ í´ë˜ìŠ¤ ì‘ì„±
   - @Inheritance, @Embeddable, @JoinTable ì ìš©
   â†“
6. êµ¬í˜„ ì‹œ ì£¼ì˜ì  ì ìš©
   - LAZY ë¡œë”©, Cascade, í¸ì˜ ë©”ì„œë“œ, ì»¬ë ‰ì…˜ ì´ˆê¸°í™”
   - ë„¤ì´ë° ì „ëµ(SpringPhysicalNamingStrategy)
```

**ì™œ ì´ ìˆœì„œì¸ê°€?**

- **ìš”êµ¬ì‚¬í•­ ë¨¼ì €**: ë¬´ì—‡ì„ ë§Œë“¤ì§€ ëª…í™•í•´ì•¼ ì„¤ê³„ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
- **ë„ë©”ì¸ ëª¨ë¸ â†’ í…Œì´ë¸” ìˆœì„œ**: ê°ì²´ ì§€í–¥ì ìœ¼ë¡œ ë¨¼ì € ì„¤ê³„í•œ ë’¤, DB í…Œì´ë¸”ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
- **í…Œì´ë¸” ì„¤ê³„ í›„ ì—°ê´€ê´€ê³„ ë¶„ì„**: FK ìœ„ì¹˜ê°€ ê²°ì •ë˜ì–´ì•¼ JPA ì—°ê´€ê´€ê³„ ì£¼ì¸ì„ í™•ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ì„¤ê³„ ì™„ë£Œ í›„ êµ¬í˜„**: ì„¤ê³„ë„ê°€ í™•ì •ë˜ì–´ì•¼ ì½”ë“œë¥¼ ì˜¬ë°”ë¥´ê²Œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“– ëª©ì°¨

1. [ìš”êµ¬ì‚¬í•­ ë¶„ì„](#1-ìš”êµ¬ì‚¬í•­-ë¶„ì„)
2. [ë„ë©”ì¸ ëª¨ë¸ ì„¤ê³„](#2-ë„ë©”ì¸-ëª¨ë¸-ì„¤ê³„)
3. [í…Œì´ë¸” ì„¤ê³„ (ERD)](#3-í…Œì´ë¸”-ì„¤ê³„-erd)
4. [ì—°ê´€ê´€ê³„ ë§¤í•‘ ë¶„ì„](#4-ì—°ê´€ê´€ê³„-ë§¤í•‘-ë¶„ì„)
5. [ì—”í‹°í‹° í´ë˜ìŠ¤ ê°œë°œ](#5-ì—”í‹°í‹°-í´ë˜ìŠ¤-ê°œë°œ)
6. [ì„¤ê³„ í•µì‹¬ ì£¼ì˜ì  ë° êµ¬í˜„ ì‹œ ì£¼ì˜ì ](#6-ì„¤ê³„-í•µì‹¬-ì£¼ì˜ì -ë°-êµ¬í˜„-ì‹œ-ì£¼ì˜ì )
7. [ë¶€ë¡](#7-ë¶€ë¡)

---

## 1. ìš”êµ¬ì‚¬í•­ ë¶„ì„

### 1.1 ê¸°ëŠ¥ ëª©ë¡

ì´ í”„ë¡œì íŠ¸ëŠ” ê°„ë‹¨í•œ **ì˜¨ë¼ì¸ ì‡¼í•‘ëª°(jpashop)**ì…ë‹ˆë‹¤. ì‹¤ë¬´ ìˆ˜ì¤€ì˜ ë³µì¡í•œ ë„ë©”ì¸ì„ JPAë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

#### íšŒì› ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **íšŒì› ë“±ë¡** | ì´ë¦„ê³¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ íšŒì› ê°€ì… |
| **íšŒì› ì¡°íšŒ** | ì „ì²´ íšŒì› ëª©ë¡ì„ ì¡°íšŒ |

#### ìƒí’ˆ ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **ìƒí’ˆ ë“±ë¡** | ìƒí’ˆ(ë„ì„œ/ìŒë°˜/ì˜í™”) ì •ë³´ë¥¼ ë“±ë¡ |
| **ìƒí’ˆ ìˆ˜ì •** | ë“±ë¡ëœ ìƒí’ˆì˜ ì •ë³´ë¥¼ ìˆ˜ì • |
| **ìƒí’ˆ ì¡°íšŒ** | ì „ì²´ ìƒí’ˆ ëª©ë¡ì„ ì¡°íšŒ |

#### ì£¼ë¬¸ ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **ìƒí’ˆ ì£¼ë¬¸** | íšŒì›ì´ ì›í•˜ëŠ” ìƒí’ˆì„ ì„ íƒí•´ ì£¼ë¬¸ |
| **ì£¼ë¬¸ ë‚´ì—­ ì¡°íšŒ** | íšŒì›ë³„ ì£¼ë¬¸ ì´ë ¥ì„ ì¡°íšŒ |
| **ì£¼ë¬¸ ì·¨ì†Œ** | ë°°ì†¡ ì „ ì£¼ë¬¸ì„ ì·¨ì†Œ |

#### ê¸°íƒ€ ìš”êµ¬ì‚¬í•­

| í•­ëª© | ì„¤ëª… |
|------|------|
| **ì¬ê³  ê´€ë¦¬** | ìƒí’ˆì€ ì¬ê³  ìˆ˜ëŸ‰ì„ ê´€ë¦¬í•˜ë©°, ì£¼ë¬¸ ì‹œ ì¬ê³ ê°€ ê°ì†Œ |
| **ìƒí’ˆ ë¶„ë¥˜** | ìƒí’ˆì€ ë„ì„œ(Book), ìŒë°˜(Album), ì˜í™”(Movie)ë¡œ êµ¬ë¶„ |
| **ì¹´í…Œê³ ë¦¬** | ìƒí’ˆì— ì¹´í…Œê³ ë¦¬ë¥¼ ì§€ì • ê°€ëŠ¥ |
| **ë°°ì†¡ ì •ë³´** | ì£¼ë¬¸ ì‹œ ë°°ì†¡ ì •ë³´(ì£¼ì†Œ, ìƒíƒœ)ë¥¼ í•¨ê»˜ ì €ì¥ |

### 1.2 ë„ë©”ì¸ ìš”ì†Œ ì¶”ì¶œ (ì—”í‹°í‹° í›„ë³´)

ìš”êµ¬ì‚¬í•­ì—ì„œ ëª…ì‚¬(ì£¼ìš” ê°œë…)ë¥¼ ì¶”ì¶œí•˜ë©´ ì—”í‹°í‹° í›„ë³´ê°€ ë©ë‹ˆë‹¤.

```
ìš”êµ¬ì‚¬í•­ â†’ ë„ë©”ì¸ ìš”ì†Œ

"íšŒì›ì´ ìƒí’ˆì„ ì£¼ë¬¸í•œë‹¤"
  â†’ Member (íšŒì›)
  â†’ Order (ì£¼ë¬¸)
  â†’ Item (ìƒí’ˆ)

"ì£¼ë¬¸ì—ëŠ” ì—¬ëŸ¬ ìƒí’ˆì´ í¬í•¨ëœë‹¤"
  â†’ OrderItem (ì£¼ë¬¸ ìƒí’ˆ, ì¤‘ê°„ ì—”í‹°í‹°)

"ì£¼ë¬¸ ì‹œ ë°°ì†¡ ì •ë³´ë¥¼ ì €ì¥í•œë‹¤"
  â†’ Delivery (ë°°ì†¡)

"ìƒí’ˆì€ ì¹´í…Œê³ ë¦¬ì— ì†í•œë‹¤"
  â†’ Category (ì¹´í…Œê³ ë¦¬)

"íšŒì›ì€ ì£¼ì†Œë¥¼ ê°€ì§„ë‹¤"
  â†’ Address (ì£¼ì†Œ - ê°’ íƒ€ì… Embeddable)

"ìƒí’ˆì€ ë„ì„œ/ìŒë°˜/ì˜í™”ë¡œ êµ¬ë¶„ëœë‹¤"
  â†’ Book, Album, Movie (Item ìƒì†)
```

---

## 2. ë„ë©”ì¸ ëª¨ë¸ ì„¤ê³„

### 2.1 ë„ë©”ì¸ ëª¨ë¸ ë‹¤ì´ì–´ê·¸ë¨ (í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨)

ê°ì²´ ê´€ì ì—ì„œ ì—”í‹°í‹° ê°„ì˜ ê´€ê³„ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ë„ë©”ì¸ ëª¨ë¸ ë‹¤ì´ì–´ê·¸ë¨                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Member    â”‚
                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                    â”‚ id: Long     â”‚
                    â”‚ name: String â”‚
                    â”‚ address:     â”‚â—„â”€â”€â”€ @Embedded
                    â”‚   Address    â”‚     (ê°’ íƒ€ì…)
                    â”‚ orders:      â”‚
                    â”‚  List<Order> â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ 1
                           â”‚ (ì–‘ë°©í–¥)
                           â”‚ N
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Order     â”‚   1 : 1  â”‚      Delivery       â”‚
                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                    â”‚ id: Long     â”‚          â”‚ id: Long            â”‚
                    â”‚ member:      â”‚          â”‚ address: Address    â”‚
                    â”‚  Member      â”‚          â”‚ status: DeliveryStatusâ”‚
                    â”‚ orderItems:  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚  List<OI>    â”‚
                    â”‚ delivery:    â”‚
                    â”‚  Delivery    â”‚
                    â”‚ status:      â”‚
                    â”‚  OrderStatus â”‚
                    â”‚ orderDate:   â”‚
                    â”‚  LocalDateTimeâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ 1
                           â”‚ (ì–‘ë°©í–¥)
                           â”‚ N
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  OrderItem   â”‚
                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                    â”‚ id: Long     â”‚
                    â”‚ item: Item   â”‚â—„â”€â”€â”€â”€ N : 1
                    â”‚ order: Order â”‚
                    â”‚ orderPrice:  â”‚
                    â”‚  int         â”‚
                    â”‚ count: int   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Item      â”‚ M  :  N  â”‚    Category      â”‚
                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                    â”‚ id: Long     â”‚          â”‚ id: Long         â”‚
                    â”‚ name: String â”‚          â”‚ name: String     â”‚
                    â”‚ price: int   â”‚          â”‚ items:           â”‚
                    â”‚ stockQty: intâ”‚          â”‚  List<Item>      â”‚
                    â”‚ categories:  â”‚          â”‚ parent:          â”‚
                    â”‚  List<Cat>   â”‚          â”‚  Category        â”‚â—„â”€ ìê¸°ì°¸ì¡°
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ child:           â”‚
                           â”‚                  â”‚  List<Category>  â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚            â”‚            â”‚
         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”
         â”‚  Book  â”‚  â”‚ Album  â”‚  â”‚ Movie  â”‚
         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚
         â”‚ author â”‚  â”‚ artist â”‚  â”‚directorâ”‚
         â”‚ isbn   â”‚  â”‚ etc    â”‚  â”‚ actor  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           (ìƒì†)      (ìƒì†)      (ìƒì†)
```

### 2.2 ì—°ê´€ê´€ê³„ ìš”ì•½

| ê´€ê³„ | í˜•íƒœ | ë°©í–¥ | ì„¤ëª… |
|------|------|------|------|
| Member â†” Order | 1:N | ì–‘ë°©í–¥ | í•œ íšŒì›ì´ ì—¬ëŸ¬ ì£¼ë¬¸ |
| Order â†” OrderItem | 1:N | ì–‘ë°©í–¥ | í•œ ì£¼ë¬¸ì— ì—¬ëŸ¬ ì£¼ë¬¸ ìƒí’ˆ |
| OrderItem â†’ Item | N:1 | ë‹¨ë°©í–¥ | ì—¬ëŸ¬ ì£¼ë¬¸ìƒí’ˆì´ í•˜ë‚˜ì˜ ìƒí’ˆ ì°¸ì¡° |
| Order â†” Delivery | 1:1 | ì–‘ë°©í–¥ | ì£¼ë¬¸ í•˜ë‚˜ì— ë°°ì†¡ í•˜ë‚˜ |
| Item â†” Category | M:N | ì–‘ë°©í–¥ | ìƒí’ˆ-ì¹´í…Œê³ ë¦¬ ë‹¤ëŒ€ë‹¤ (ì¤‘ê°„ í…Œì´ë¸”) |
| Category â†’ Category | 1:N | ìê¸°ì°¸ì¡° | ì¹´í…Œê³ ë¦¬ ë¶€ëª¨-ìì‹ íŠ¸ë¦¬ |
| Item â†’ Book/Album/Movie | ìƒì† | - | ë‹¨ì¼ í…Œì´ë¸” ì „ëµ(ê¸°ë³¸) |

> **ì°¸ê³ **: íšŒì› ì—”í‹°í‹° ë¶„ì„ ê·¸ë¦¼ì—ì„œ Orderì™€ Deliveryê°€ ë‹¨ë°©í–¥ ê´€ê³„ë¡œ ì˜ëª» ê·¸ë ¤ì ¸ ìˆë‹¤. ì–‘ë°©í–¥ ê´€ê³„ê°€ ë§ë‹¤.

> **ì°¸ê³ **: ì‹¤ë¬´ì—ì„œëŠ” íšŒì›ì´ ì£¼ë¬¸ì„ ì°¸ì¡°í•˜ì§€ ì•Šê³ , ì£¼ë¬¸ì´ íšŒì›ì„ ì°¸ì¡°í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶©ë¶„í•˜ë‹¤. ì—¬ê¸°ì„œëŠ” ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ì˜ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ì„œ `Member.orders`ë¥¼ ì¶”ê°€í–ˆë‹¤.

### 2.3 Address - ê°’ íƒ€ì… (Embeddable)

`Address`ëŠ” ì—”í‹°í‹°ê°€ ì•„ë‹Œ **ê°’ íƒ€ì…(Value Object)**ì…ë‹ˆë‹¤.

```
Address (ê°’ íƒ€ì…)
â”œâ”€â”€ city: String     (ë„ì‹œ)
â”œâ”€â”€ street: String   (ê±°ë¦¬)
â””â”€â”€ zipcode: String  (ìš°í¸ë²ˆí˜¸)
```

**ì—”í‹°í‹°ì™€ ê°’ íƒ€ì…ì˜ ì°¨ì´:**

| êµ¬ë¶„ | ì—”í‹°í‹° (Entity) | ê°’ íƒ€ì… (Value Object) |
|------|----------------|----------------------|
| **ì‹ë³„ì** | `@Id`ë¡œ ê³ ìœ  ì‹ë³„ | ì‹ë³„ì ì—†ìŒ |
| **ìƒëª…ì£¼ê¸°** | ë…ë¦½ì  | ì†Œìœ  ì—”í‹°í‹°ì— ì¢…ì† |
| **ê³µìœ ** | ì—¬ëŸ¬ ê³³ì—ì„œ ì°¸ì¡° ê°€ëŠ¥ | ê³µìœ í•˜ë©´ ì•ˆ ë¨ (ë¶ˆë³€ìœ¼ë¡œ ì‚¬ìš©) |
| **JPA ì–´ë…¸í…Œì´ì…˜** | `@Entity` | `@Embeddable` |
| **ì˜ˆì‹œ** | Member, Order | Address, Money |

`Address`ëŠ” `Member`ì™€ `Delivery`ê°€ ê°ê° ê°€ì§‘ë‹ˆë‹¤. ê°™ì€ í´ë˜ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•˜ì§€ë§Œ, ê°ê° ë³„ë„ì˜ ê°’ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

---

## 3. í…Œì´ë¸” ì„¤ê³„ (ERD)

### 3.1 ERD ê°œìš”

ë„ë©”ì¸ ëª¨ë¸(ê°ì²´)ì„ ê´€ê³„í˜• DB í…Œì´ë¸”ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ERD                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       MEMBER      â”‚        â”‚               ORDERS             â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ MEMBER_ID (PK)    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”‚ ORDER_ID (PK)                    â”‚
â”‚ NAME              â”‚ 1 : N  â”‚ MEMBER_ID (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚ CITY              â”‚        â”‚ DELIVERY_ID (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ STREET            â”‚        â”‚ STATUS                           â”‚â”‚
â”‚ ZIPCODE           â”‚        â”‚ ORDER_DATE                       â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                                       â”‚ 1                        â”‚
                                       â”‚                          â”‚
                                       â”‚ N                        â–¼
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚      ORDER_ITEM       â”‚  â”‚     DELIVERY     â”‚
                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                             â”‚ ORDER_ITEM_ID (PK)    â”‚  â”‚ DELIVERY_ID (PK) â”‚
                             â”‚ ORDER_ID (FK)         â”‚  â”‚ CITY             â”‚
                             â”‚ ITEM_ID (FK)  â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ STREET           â”‚
                             â”‚ ORDER_PRICE           â”‚â”‚  â”‚ ZIPCODE          â”‚
                             â”‚ COUNT                 â”‚â”‚  â”‚ STATUS           â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼ N : 1
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚                    ITEM                      â”‚
                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                             â”‚ ITEM_ID (PK)                                 â”‚
                             â”‚ NAME                                         â”‚
                             â”‚ PRICE                                        â”‚
                             â”‚ STOCK_QUANTITY                               â”‚
                             â”‚ DTYPE (êµ¬ë¶„ ì»¬ëŸ¼: 'B'/'A'/'M')              â”‚
                             â”‚ AUTHOR / ISBN          (Book ì»¬ëŸ¼)           â”‚
                             â”‚ ARTIST / ETC           (Album ì»¬ëŸ¼)          â”‚
                             â”‚ DIRECTOR / ACTOR       (Movie ì»¬ëŸ¼)          â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚ M : N
                                            â”‚
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚        CATEGORY_ITEM         â”‚
                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                             â”‚ CATEGORY_ID (PK, FK)         â”‚â—„â”€â”€â”
                             â”‚ ITEM_ID     (PK, FK)         â”‚   â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                                                                â”‚
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚          CATEGORY
                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                             â”‚ CATEGORY_ID (PK)
                             â”‚ NAME
                             â”‚ PARENT_ID (FK, ìê¸°ì°¸ì¡°)  â”€â”€â”€â”€â”€â”
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â–²                    â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            (PARENT_ID â†’ CATEGORY_ID)
```

### 3.2 í…Œì´ë¸”ë³„ ì»¬ëŸ¼ ìƒì„¸

#### MEMBER í…Œì´ë¸”

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|--------|------|----------|------|
| MEMBER_ID | BIGINT | PK, NOT NULL | íšŒì› ì‹ë³„ì |
| NAME | VARCHAR(255) | NOT NULL | íšŒì› ì´ë¦„ |
| CITY | VARCHAR(255) | - | ì£¼ì†Œ - ë„ì‹œ (`@Embedded Address`) |
| STREET | VARCHAR(255) | - | ì£¼ì†Œ - ê±°ë¦¬ (`@Embedded Address`) |
| ZIPCODE | VARCHAR(255) | - | ì£¼ì†Œ - ìš°í¸ë²ˆí˜¸ (`@Embedded Address`) |

#### ORDERS í…Œì´ë¸”

> **ì™œ ORDERê°€ ì•„ë‹Œ ORDERSì¸ê°€?**
> `ORDER`ëŠ” SQL ì˜ˆì•½ì–´ì´ë¯€ë¡œ í…Œì´ë¸”ëª… ì¶©ëŒì„ í”¼í•˜ê¸° ìœ„í•´ `ORDERS`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|--------|------|----------|------|
| ORDER_ID | BIGINT | PK, NOT NULL | ì£¼ë¬¸ ì‹ë³„ì |
| MEMBER_ID | BIGINT | FK, NOT NULL | íšŒì› ì™¸ë˜ í‚¤ |
| DELIVERY_ID | BIGINT | FK | ë°°ì†¡ ì™¸ë˜ í‚¤ |
| STATUS | VARCHAR(255) | - | ì£¼ë¬¸ ìƒíƒœ (ORDER / CANCEL) |
| ORDER_DATE | TIMESTAMP | - | ì£¼ë¬¸ ì¼ì‹œ |

#### ORDER_ITEM í…Œì´ë¸”

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|--------|------|----------|------|
| ORDER_ITEM_ID | BIGINT | PK, NOT NULL | ì£¼ë¬¸ ìƒí’ˆ ì‹ë³„ì |
| ORDER_ID | BIGINT | FK, NOT NULL | ì£¼ë¬¸ ì™¸ë˜ í‚¤ |
| ITEM_ID | BIGINT | FK, NOT NULL | ìƒí’ˆ ì™¸ë˜ í‚¤ |
| ORDER_PRICE | INTEGER | - | ì£¼ë¬¸ ë‹¹ì‹œ ê°€ê²© |
| COUNT | INTEGER | - | ì£¼ë¬¸ ìˆ˜ëŸ‰ |

#### ITEM í…Œì´ë¸” (ë‹¨ì¼ í…Œì´ë¸” ì „ëµ - SINGLE_TABLE)

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|--------|------|----------|------|
| ITEM_ID | BIGINT | PK, NOT NULL | ìƒí’ˆ ì‹ë³„ì |
| DTYPE | VARCHAR(31) | NOT NULL | êµ¬ë¶„ ì»¬ëŸ¼ ('B'=Book, 'A'=Album, 'M'=Movie) |
| NAME | VARCHAR(255) | - | ìƒí’ˆëª… |
| PRICE | INTEGER | - | ê°€ê²© |
| STOCK_QUANTITY | INTEGER | - | ì¬ê³  ìˆ˜ëŸ‰ |
| AUTHOR | VARCHAR(255) | - | ì €ì (Book ì „ìš©) |
| ISBN | VARCHAR(255) | - | ISBN (Book ì „ìš©) |
| ARTIST | VARCHAR(255) | - | ì•„í‹°ìŠ¤íŠ¸ (Album ì „ìš©) |
| ETC | VARCHAR(255) | - | ê¸°íƒ€ ì •ë³´ (Album ì „ìš©) |
| DIRECTOR | VARCHAR(255) | - | ê°ë… (Movie ì „ìš©) |
| ACTOR | VARCHAR(255) | - | ë°°ìš° (Movie ì „ìš©) |

#### DELIVERY í…Œì´ë¸”

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|--------|------|----------|------|
| DELIVERY_ID | BIGINT | PK, NOT NULL | ë°°ì†¡ ì‹ë³„ì |
| STATUS | VARCHAR(255) | - | ë°°ì†¡ ìƒíƒœ (READY / COMP) |
| CITY | VARCHAR(255) | - | ì£¼ì†Œ - ë„ì‹œ |
| STREET | VARCHAR(255) | - | ì£¼ì†Œ - ê±°ë¦¬ |
| ZIPCODE | VARCHAR(255) | - | ì£¼ì†Œ - ìš°í¸ë²ˆí˜¸ |

#### CATEGORY í…Œì´ë¸”

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|--------|------|----------|------|
| CATEGORY_ID | BIGINT | PK, NOT NULL | ì¹´í…Œê³ ë¦¬ ì‹ë³„ì |
| PARENT_ID | BIGINT | FK (ìê¸°ì°¸ì¡°) | ë¶€ëª¨ ì¹´í…Œê³ ë¦¬ ID |
| NAME | VARCHAR(255) | - | ì¹´í…Œê³ ë¦¬ ì´ë¦„ |

#### CATEGORY_ITEM í…Œì´ë¸” (ì¡°ì¸ í…Œì´ë¸”)

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|--------|------|----------|------|
| CATEGORY_ID | BIGINT | PK, FK | ì¹´í…Œê³ ë¦¬ ì™¸ë˜ í‚¤ |
| ITEM_ID | BIGINT | PK, FK | ìƒí’ˆ ì™¸ë˜ í‚¤ |

### 3.3 ê°ì²´ ëª¨ë¸ vs í…Œì´ë¸” ëª¨ë¸ ë¹„êµ

| ë„ë©”ì¸ ê°ì²´ | DB í…Œì´ë¸” | ì£¼ìš” ì°¨ì´ì  |
|------------|----------|------------|
| `Member` | `MEMBER` | `Address`ëŠ” í…Œì´ë¸”ì— ì»¬ëŸ¼ìœ¼ë¡œ í¼ì³ì§ |
| `Order` | `ORDERS` | ì˜ˆì•½ì–´ ì¶©ëŒë¡œ ì´ë¦„ ë³€ê²½ |
| `OrderItem` | `ORDER_ITEM` | ë™ì¼ |
| `Item` (ì¶”ìƒ) + Book/Album/Movie | `ITEM` (ë‹¨ì¼ í…Œì´ë¸”) | ìƒì†ì„ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ í‘œí˜„, `DTYPE` ì»¬ëŸ¼ ì¶”ê°€ |
| `Delivery` | `DELIVERY` | `Address`ëŠ” í…Œì´ë¸”ì— ì»¬ëŸ¼ìœ¼ë¡œ í¼ì³ì§ |
| `Category` | `CATEGORY` | ìê¸°ì°¸ì¡°ë¡œ `PARENT_ID` ì¶”ê°€ |
| `Category` â†” `Item` (M:N) | `CATEGORY_ITEM` | M:Nì€ ì¡°ì¸ í…Œì´ë¸”ë¡œ ë³€í™˜ |

**ê°ì²´ì™€ í…Œì´ë¸”ì˜ ê·¼ë³¸ì ì¸ ì°¨ì´:**

```
[ê°ì²´ ì„¸ê³„]
Order.getMember()  â†’  Member ê°ì²´ë¥¼ ì§ì ‘ ì°¸ì¡°

[í…Œì´ë¸” ì„¸ê³„]
ORDERS.MEMBER_ID  â†’  MEMBER_ID ê°’(ìˆ«ì)ì„ ì €ì¥
                      JOINìœ¼ë¡œ ì—°ê²°í•´ì„œ ë°ì´í„° ê°€ì ¸ì˜´

â†’ JPAê°€ ì´ ë‘ ì„¸ê³„ì˜ ì°¨ì´(íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜)ë¥¼ í•´ê²°í•´ ì¤ë‹ˆë‹¤.
```

---

## 4. ì—°ê´€ê´€ê³„ ë§¤í•‘ ë¶„ì„

### 4.1 ì—°ê´€ê´€ê³„ ì£¼ì¸(Owner) ê°œë…

JPAì—ì„œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•Œ ê°€ì¥ ì¤‘ìš”í•œ ê°œë…ì´ **ì—°ê´€ê´€ê³„ ì£¼ì¸**ì…ë‹ˆë‹¤.

**ì™œ ì£¼ì¸ì´ í•„ìš”í•œê°€?**

```
[ê°ì²´ì˜ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„]

Member.orders â†’ Order ëª©ë¡ ì°¸ì¡°
Order.member  â†’ Member ì°¸ì¡°

â†’ ë‘ ë°©í–¥ ëª¨ë‘ ì¡´ì¬

[í…Œì´ë¸”ì˜ FK]

ORDERS.MEMBER_ID â†’ í•˜ë‚˜ì˜ FKë§Œ ì¡´ì¬

â†’ ì–´ëŠ ìª½ ê°ì²´ì˜ ë³€ê²½ì´ FKë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•˜ëŠ”ê°€?
â†’ ë°˜ë“œì‹œ í•˜ë‚˜ë¥¼ "ì£¼ì¸"ìœ¼ë¡œ ì§€ì •í•´ì•¼ í•¨!
```

**ì—°ê´€ê´€ê³„ ì£¼ì¸ì˜ ê·œì¹™:**

| êµ¬ë¶„ | ì„¤ëª… |
|------|------|
| **ì£¼ì¸ (Owner)** | FKë¥¼ ì§ì ‘ ê´€ë¦¬ â†’ `@JoinColumn` ì‚¬ìš©, ë°ì´í„° ë³€ê²½ ì‹œ UPDATE/INSERT ë°œìƒ |
| **ë¹„ì£¼ì¸ (Inverse)** | FKë¥¼ ì½ê¸°ë§Œ í•¨ â†’ `mappedBy` ì†ì„±ìœ¼ë¡œ ì£¼ì¸ ëª…ì‹œ, ë°ì´í„° ë³€ê²½ ì‹œ ë¬´ì‹œë¨ |

**ì£¼ì¸ ì„ íƒ ê¸°ì¤€:**

```
FKê°€ ìˆëŠ” ìª½ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸!

ORDERS.MEMBER_ID (FK)  â†’  Orderê°€ ì£¼ì¸
ORDER_ITEM.ORDER_ID (FK)  â†’  OrderItemì´ ì£¼ì¸
ORDER_ITEM.ITEM_ID (FK)  â†’  OrderItemì´ ì£¼ì¸
ORDERS.DELIVERY_ID (FK)  â†’  Orderê°€ ì£¼ì¸
```

> **ì°¸ê³ **: ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ ë‹¨ìˆœíˆ ì™¸ë˜ í‚¤ë¥¼ ëˆ„ê°€ ê´€ë¦¬í•˜ëƒì˜ ë¬¸ì œì´ì§€ ë¹„ì¦ˆë‹ˆìŠ¤ìƒ ìš°ìœ„ì— ìˆë‹¤ê³  ì£¼ì¸ìœ¼ë¡œ ì •í•˜ë©´ ì•ˆëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìë™ì°¨ì™€ ë°”í€´ê°€ ìˆìœ¼ë©´, ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„œ í•­ìƒ ë‹¤ìª½ì— ì™¸ë˜ í‚¤ê°€ ìˆìœ¼ë¯€ë¡œ ì™¸ë˜ í‚¤ê°€ ìˆëŠ” **ë°”í€´ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸**ìœ¼ë¡œ ì •í•˜ë©´ ëœë‹¤.

### 4.2 ì—°ê´€ê´€ê³„ ë§¤í•‘ ë¶„ì„í‘œ

| ì—”í‹°í‹° ìŒ | ê´€ê³„ | FK ìœ„ì¹˜ | ì£¼ì¸ | mappedBy ì„¤ì • |
|-----------|------|---------|------|--------------|
| Member â†” Order | 1:N (ì–‘ë°©í–¥) | ORDERS.MEMBER_ID | **Order** | Member.ordersì— `mappedBy="member"` |
| Order â†” OrderItem | 1:N (ì–‘ë°©í–¥) | ORDER_ITEM.ORDER_ID | **OrderItem** | Order.orderItemsì— `mappedBy="order"` |
| OrderItem â†’ Item | N:1 (ë‹¨ë°©í–¥) | ORDER_ITEM.ITEM_ID | **OrderItem** | - (ë‹¨ë°©í–¥ì´ë¯€ë¡œ mappedBy ì—†ìŒ) |
| Order â†” Delivery | 1:1 (ì–‘ë°©í–¥) | ORDERS.DELIVERY_ID | **Order** | Delivery.orderì— `mappedBy="delivery"` |
| Item â†” Category | M:N (ì–‘ë°©í–¥) | CATEGORY_ITEM (ì¡°ì¸ í…Œì´ë¸”) | **Category** | Item.categoriesì— `mappedBy="items"` |
| Category â†’ Category | 1:N (ìê¸°ì°¸ì¡°) | CATEGORY.PARENT_ID | **Category(ìì‹)** | Category.childì— `mappedBy="parent"` |

### 4.3 ê´€ê³„ë³„ ìƒì„¸ ë¶„ì„

#### 4.3.1 Member (1) - Order (N): ì–‘ë°©í–¥ 1:N

```
[ê°ì²´]
Member.orders : List<Order>     â† ë¹„ì£¼ì¸ (mappedBy = "member")
Order.member  : Member          â† ì£¼ì¸ (@ManyToOne, @JoinColumn)

[í…Œì´ë¸”]
MEMBER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ORDERS
MEMBER_ID (PK)         ORDER_ID (PK)
                        MEMBER_ID (FK) â† ì´ FKë¥¼ Orderê°€ ê´€ë¦¬
```

```java
// Member (ë¹„ì£¼ì¸ - ì½ê¸° ì „ìš©)
@OneToMany(mappedBy = "member")
private List<Order> orders = new ArrayList<>();

// Order (ì£¼ì¸ - FK ê´€ë¦¬)
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "MEMBER_ID")
private Member member;
```

#### 4.3.2 Order (1) - OrderItem (N): ì–‘ë°©í–¥ 1:N

```
[ê°ì²´]
Order.orderItems    : List<OrderItem>  â† ë¹„ì£¼ì¸ (mappedBy = "order")
OrderItem.order     : Order            â† ì£¼ì¸ (@ManyToOne, @JoinColumn)

[í…Œì´ë¸”]
ORDERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ORDER_ITEM
ORDER_ID (PK)              ORDER_ITEM_ID (PK)
                            ORDER_ID (FK) â† ì´ FKë¥¼ OrderItemì´ ê´€ë¦¬
```

```java
// Order (ë¹„ì£¼ì¸ - ì½ê¸° ì „ìš©)
@OneToMany(mappedBy = "order")
private List<OrderItem> orderItems = new ArrayList<>();

// OrderItem (ì£¼ì¸ - FK ê´€ë¦¬)
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "ORDER_ID")
private Order order;
```

#### 4.3.3 OrderItem (N) - Item (1): ë‹¨ë°©í–¥ N:1

```
[ê°ì²´]
OrderItem.item : Item   â† ì£¼ì¸ (ë‹¨ë°©í–¥, @ManyToOne, @JoinColumn)
ItemëŠ” OrderItemì„ ì°¸ì¡°í•˜ì§€ ì•ŠìŒ

[í…Œì´ë¸”]
ORDER_ITEM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ITEM
ORDER_ITEM_ID (PK)             ITEM_ID (PK)
ITEM_ID (FK) â† OrderItemì´ ê´€ë¦¬
```

```java
// OrderItem (ì£¼ì¸ - ë‹¨ë°©í–¥)
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "ITEM_ID")
private Item item;

// Itemì—ëŠ” OrderItem ì°¸ì¡° ì—†ìŒ (ë‹¨ë°©í–¥)
```

#### 4.3.4 Order (1) - Delivery (1): ì–‘ë°©í–¥ 1:1

```
[ê°ì²´]
Order.delivery       : Delivery  â† ì£¼ì¸ (@OneToOne, @JoinColumn)
Delivery.order       : Order     â† ë¹„ì£¼ì¸ (mappedBy = "delivery")

[í…Œì´ë¸”]
ORDERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ DELIVERY
ORDER_ID (PK)              DELIVERY_ID (PK)
DELIVERY_ID (FK) â† Orderê°€ ê´€ë¦¬
```

```java
// Order (ì£¼ì¸ - FK ê´€ë¦¬)
@OneToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "DELIVERY_ID")
private Delivery delivery;

// Delivery (ë¹„ì£¼ì¸ - ì½ê¸° ì „ìš©)
@OneToOne(mappedBy = "delivery", fetch = FetchType.LAZY)
private Order order;
```

**1:1 ê´€ê³„ì—ì„œ FKë¥¼ ì–´ëŠ ìª½ì— ë‘ëŠ”ê°€?**

```
ì£¼ í…Œì´ë¸”(ì£¼ë¡œ ì ‘ê·¼í•˜ëŠ” ìª½)ì— FKë¥¼ ë‘ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤.
â†’ ì£¼ë¬¸(Order)ì´ ì£¼ í…Œì´ë¸”ì´ë¯€ë¡œ ORDERSì— DELIVERY_ID ë°°ì¹˜
â†’ ì¥ì : Order ì¡°íšŒ ì‹œ JOIN ì—†ì´ DELIVERY_ID í™•ì¸ ê°€ëŠ¥
```

#### 4.3.5 Item (M) - Category (N): ì–‘ë°©í–¥ M:N

```
[ê°ì²´]
Category.items    : List<Item>     â† ì£¼ì¸ (@ManyToMany, @JoinTable)
Item.categories   : List<Category> â† ë¹„ì£¼ì¸ (mappedBy = "items")

[í…Œì´ë¸”]
ITEM â”€â”€â”€â”€â”€â”€â”€ CATEGORY_ITEM â”€â”€â”€â”€â”€â”€â”€ CATEGORY
ITEM_ID(PK)  ITEM_ID(PK, FK)       CATEGORY_ID(PK)
             CATEGORY_ID(PK, FK)
```

```java
// Category (ì£¼ì¸ - @JoinTableë¡œ ì¡°ì¸ í…Œì´ë¸” ëª…ì‹œ)
@ManyToMany
@JoinTable(
    name = "CATEGORY_ITEM",
    joinColumns = @JoinColumn(name = "CATEGORY_ID"),
    inverseJoinColumns = @JoinColumn(name = "ITEM_ID")
)
private List<Item> items = new ArrayList<>();

// Item (ë¹„ì£¼ì¸ - ì½ê¸° ì „ìš©)
@ManyToMany(mappedBy = "items")
private List<Category> categories = new ArrayList<>();
```

> âš ï¸ **ì£¼ì˜**: M:N ê´€ê³„ë¥¼ `@ManyToMany`ë¡œ êµ¬í˜„í•˜ë©´ ì‹¤ë¬´ì—ì„œ ë¬¸ì œê°€ ë§ìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [6.1ì ˆ](#61-manytomany-ì‚¬ìš©ì„-ì§€ì–‘í•´ì•¼-í•˜ëŠ”-ì´ìœ )ì„ ì°¸ê³ í•˜ì„¸ìš”.

#### 4.3.6 Category ìê¸°ì°¸ì¡°: ë¶€ëª¨-ìì‹ íŠ¸ë¦¬

```
[ê°ì²´]
Category.parent   : Category        â† ì£¼ì¸ (N:1, @ManyToOne)
Category.child    : List<Category>  â† ë¹„ì£¼ì¸ (1:N, mappedBy = "parent")

[í…Œì´ë¸”]
CATEGORY
CATEGORY_ID (PK)
PARENT_ID (FK â†’ CATEGORY_ID) â† ìê¸° ìì‹ ì„ ì°¸ì¡°
```

```
ì¹´í…Œê³ ë¦¬ íŠ¸ë¦¬ ì˜ˆì‹œ:
CATEGORY_ID   NAME       PARENT_ID
1             ì „ì²´        NULL
2             ìŒì‹        1
3             í•œì‹        2
4             ì¤‘ì‹        2
5             ì „ìì œí’ˆ    1
6             ê°€ì „        5
```

```java
// Category
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "PARENT_ID")
private Category parent;

@OneToMany(mappedBy = "parent")
private List<Category> child = new ArrayList<>();
```

---

## 5. ì—”í‹°í‹° í´ë˜ìŠ¤ ê°œë°œ

### 5.1 ì—”í‹°í‹° ê°œë°œ ì¤€ë¹„ â€” í•„ë…! ì£¼ì˜!

ì—”í‹°í‹° í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•˜ê¸° ì „ì— ë°˜ë“œì‹œ ì•„ë˜ ì‚¬í•­ì„ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.

**â‘  ì´ˆê¸° í™˜ê²½ì„¤ì •ì—ì„œ ë§Œë“  íŒŒì¼ ì œê±°**

ì±•í„° 1(í”„ë¡œì íŠ¸ í™˜ê²½ì„¤ì •)ì—ì„œ í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œ ë§Œë“  3ê°œ íŒŒì¼ì´ ìˆìœ¼ë©´, ìƒˆë¡œ ì‘ì„±í•  `Member` ì—”í‹°í‹°ì™€ ì¶©ëŒì´ ë°œìƒí•©ë‹ˆë‹¤. ì•„ë˜ íŒŒì¼ë“¤ì„ ë°˜ë“œì‹œ ì œê±°í•˜ì„¸ìš”:

```
ì‚­ì œ ëŒ€ìƒ:
â”œâ”€â”€ src/main/java/jpabook/jpashop/Member.java          (ë£¨íŠ¸ íŒ¨í‚¤ì§€ì˜ Member)
â”œâ”€â”€ src/main/java/jpabook/jpashop/MemberRepository.java
â””â”€â”€ src/test/java/jpabook/jpashop/MemberRepositoryTest.java
```

**â‘¡ Spring Boot 3.x ì„í¬íŠ¸ ë³€ê²½**

ê°•ì˜ ì˜ìƒì€ Spring Boot 2.x ê¸°ì¤€ì´ë¯€ë¡œ `javax.persistence.*`ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ, ì´ í”„ë¡œì íŠ¸ëŠ” Spring Boot 4.x (Jakarta EE ê¸°ë°˜)ì´ë¯€ë¡œ ë°˜ë“œì‹œ `jakarta.persistence.*`ë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.

```java
// âŒ ì˜ìƒì˜ ë°©ì‹ (Spring Boot 2.x)
import javax.persistence.*;

// âœ… ì´ í”„ë¡œì íŠ¸ ë°©ì‹ (Spring Boot 3.x / 4.x)
import jakarta.persistence.*;
```

**â‘¢ ì´ ê°•ì˜ì—ì„œì˜ Getter/Setter ì •ì±…**

ê°•ì˜ì—ì„œëŠ” ì„¤ëª… í¸ì˜ë¥¼ ìœ„í•´ `@Getter @Setter` ëª¨ë‘ ì—´ì–´ë‘ì§€ë§Œ, **ì‹¤ë¬´ì—ì„œëŠ” Getterë§Œ ì—´ì–´ë‘ëŠ” ê²ƒì„ ê¶Œì¥**í•©ë‹ˆë‹¤. SetterëŠ” ê°’ì´ ë³€ê²½ë˜ëŠ” ì‹œì ì´ ë§ì•„ì§€ë©´ ë²„ê·¸ ì¶”ì ì´ ì–´ë ¤ì›Œì§€ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´í›„ ì±•í„°ì—ì„œ ì ì§„ì ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.

**â‘£ ì—”í‹°í‹° í´ë˜ìŠ¤ ê°œë°œ ìˆœì„œ**

```
1. Address.java          ê°’ íƒ€ì… ë¨¼ì € (ì—”í‹°í‹°ê°€ ì˜ì¡´í•˜ë¯€ë¡œ)
2. OrderStatus.java      Enum íƒ€ì…
3. DeliveryStatus.java   Enum íƒ€ì…
4. Member.java           ê°€ì¥ ë‹¨ìˆœí•œ ì—”í‹°í‹°
5. Item.java             ì¶”ìƒ í´ë˜ìŠ¤ (ìƒì† ì „ëµ ê²°ì •)
6. Book / Album / Movie  Item ì„œë¸Œí´ë˜ìŠ¤
7. Delivery.java         Orderê°€ ì°¸ì¡°í•˜ë¯€ë¡œ ë¨¼ì €
8. Order.java            Cascade, í¸ì˜ ë©”ì„œë“œ í¬í•¨
9. OrderItem.java        Order ì´í›„
10. Category.java        M:N + ìê¸°ì°¸ì¡°
```

### 5.2 Address.java â€” ê°’ íƒ€ì… êµ¬í˜„

`Address`ëŠ” `@Embeddable` ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ì„ ì–¸í•˜ëŠ” **ê°’ íƒ€ì…(Value Object)**ì…ë‹ˆë‹¤.

```java
package jpabook.jpashop.domain;

import jakarta.persistence.Embeddable;
import lombok.Getter;

@Embeddable
@Getter
public class Address {

    private String city;
    private String street;
    private String zipcode;

    protected Address() {
    }

    public Address(String city, String street, String zipcode) {
        this.city = city;
        this.street = street;
        this.zipcode = zipcode;
    }
}
```

**í•µì‹¬ í¬ì¸íŠ¸:**

| í•­ëª© | ì„¤ëª… |
|------|------|
| `@Embeddable` | "ë‚˜ëŠ” ì–´ë”˜ê°€ì— ë‚´ì¥ë  ìˆ˜ ìˆëŠ” íƒ€ì…"ì´ë¼ëŠ” ì„ ì–¸. ì´ ì–´ë…¸í…Œì´ì…˜ì´ ìˆì–´ì•¼ ë‹¤ë¥¸ ì—”í‹°í‹°ì—ì„œ `@Embedded`ë¡œ í¬í•¨ ê°€ëŠ¥ |
| `protected Address()` | JPAëŠ” reflection/proxy ê¸°ìˆ ì„ ìœ„í•´ ê¸°ë³¸ ìƒì„±ìê°€ ë°˜ë“œì‹œ í•„ìš”. `public`ìœ¼ë¡œ í•˜ë©´ ì™¸ë¶€ì—ì„œ ì§ì ‘ í˜¸ì¶œ ê°€ëŠ¥í•´ì§€ë¯€ë¡œ, JPAê°€ í—ˆìš©í•˜ëŠ” ìµœì†Œ ì ‘ê·¼ ìˆ˜ì¤€ì¸ `protected`ë¥¼ ì‚¬ìš© |
| Setter ì—†ìŒ | ê°’ íƒ€ì…ì€ **ë¶ˆë³€(Immutable)**ìœ¼ë¡œ ì„¤ê³„í•´ì•¼ ë¶€ì‘ìš© ì—†ìŒ. ê°’ì„ ë°”ê¾¸ë ¤ë©´ ìƒˆ ê°ì²´ë¥¼ ë§Œë“¤ì–´ êµì²´ |
| `@Getter`ë§Œ ì„ ì–¸ | ì¡°íšŒëŠ” í—ˆìš©í•˜ë˜ ìˆ˜ì •ì€ ë§‰ìŒ |

```
[ê°’ íƒ€ì… ê³µìœ ì˜ ìœ„í—˜ì„±]

Address address = new Address("Seoul", "Gangnam", "12345");
member.setAddress(address);
delivery.setAddress(address);  // ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ ê³µìœ !

address.setCity("Busan");      // memberì™€ delivery ëª¨ë‘ ë³€ê²½ë¨ â†’ ì‚¬ì´ë“œ ì´í™íŠ¸!

â†’ Addressë¥¼ ë¶ˆë³€ìœ¼ë¡œ ë§Œë“¤ì–´ setterë¥¼ ì œê±°í•˜ë©´ ì´ ë¬¸ì œê°€ ì›ì²œ ì°¨ë‹¨ë¨
```

### 5.3 Enum íƒ€ì… â€” OrderStatus, DeliveryStatus

**OrderStatus.java**

```java
package jpabook.jpashop.domain;

public enum OrderStatus {
    ORDER, CANCEL
}
```

**DeliveryStatus.java**

```java
package jpabook.jpashop.domain;

public enum DeliveryStatus {
    READY, COMP
}
```

**`@Enumerated` â€” EnumType.STRING vs ORDINAL:**

| ì „ëµ | ì €ì¥ ë°©ì‹ | ë¬¸ì œì  |
|------|-----------|--------|
| `EnumType.ORDINAL` | ìˆ«ì(0, 1, 2...)ë¡œ ì €ì¥ | Enum í•­ëª© ì¤‘ê°„ì— ìƒˆ ê°’ ì¶”ê°€ ì‹œ ê¸°ì¡´ ë°ì´í„° ì˜¤ì—¼. ì˜ˆ) `ORDER(0), CANCEL(1)` ì´ì—ˆëŠ”ë° `PENDING(0), ORDER(1), CANCEL(2)`ë¡œ ë°”ë€Œë©´ DBì˜ 0ì´ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ í‹€ë ¤ì§ |
| `EnumType.STRING` | ì´ë¦„("ORDER", "CANCEL")ìœ¼ë¡œ ì €ì¥ | ì¤‘ê°„ì— ê°’ ì¶”ê°€í•´ë„ ê¸°ì¡´ ë°ì´í„° ì˜í–¥ ì—†ìŒ |

```java
// âŒ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€
@Enumerated(EnumType.ORDINAL)
private OrderStatus status;

// âœ… ë°˜ë“œì‹œ STRING ì‚¬ìš©
@Enumerated(EnumType.STRING)
private OrderStatus status;
```

### 5.4 Member.java

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;

import java.util.ArrayList;
import java.util.List;

@Entity
@Getter @Setter
public class Member {

    @Id @GeneratedValue
    @Column(name = "member_id")
    private Long id;

    private String name;

    @Embedded
    private Address address;

    // ì—°ê´€ê´€ê³„ ì£¼ì¸ì´ ì•„ë‹˜ (ë¹„ì£¼ì¸)
    // mappedByì— ê°’ì„ ë„£ì–´ë„ ì™¸ë˜ í‚¤(MEMBER_ID)ê°€ ë³€ê²½ë˜ì§€ ì•ŠìŒ
    @OneToMany(mappedBy = "member")
    private List<Order> orders = new ArrayList<>();
}
```

**í•µì‹¬ í¬ì¸íŠ¸:**

| í•­ëª© | ì„¤ëª… |
|------|------|
| `@Column(name = "member_id")` | ìŠ¤í”„ë§ì˜ ë„¤ì´ë° ì „ëµì— ì˜í•´ ìë™ìœ¼ë¡œ `member_id`ë¡œ ë³€í™˜ë˜ì§€ë§Œ, ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•´ ì˜ë„ë¥¼ ëª…í™•íˆ í•¨ |
| `@Embedded` | `Address` ê°’ íƒ€ì…ì„ í¬í•¨. í…Œì´ë¸”ì—ëŠ” `city`, `street`, `zipcode`ë¡œ ì»¬ëŸ¼ì´ í¼ì³ì§ |
| `@OneToMany(mappedBy = "member")` | Order ì—”í‹°í‹°ì˜ `member` í•„ë“œê°€ ì—°ê´€ê´€ê³„ ì£¼ì¸. MemberëŠ” ë¹„ì£¼ì¸ìœ¼ë¡œ ì½ê¸° ì „ìš© |
| `= new ArrayList<>()` | ì»¬ë ‰ì…˜ì€ í•„ë“œì—ì„œ ë°”ë¡œ ì´ˆê¸°í™” (ì´ìœ ëŠ” [6.9ì ˆ](#69-ì»¬ë ‰ì…˜ì€-í•„ë“œì—ì„œ-ì´ˆê¸°í™”) ì°¸ê³ ) |

### 5.5 Item.java â€” ì¶”ìƒ í´ë˜ìŠ¤ì™€ ë‹¨ì¼ í…Œì´ë¸” ì „ëµ

```java
package jpabook.jpashop.domain.Item;

import jakarta.persistence.*;
import jpabook.jpashop.domain.Category;
import lombok.Getter;
import lombok.Setter;

import java.util.ArrayList;
import java.util.List;

@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "dtype")
@Getter @Setter
public abstract class Item {

    @Id @GeneratedValue
    @Column(name = "item_id")
    private Long id;

    private String name;
    private int price;
    private int stockQuantity;

    @ManyToMany(mappedBy = "items")
    private List<Category> categories = new ArrayList<>();
}
```

**ìƒì† ì „ëµ ë¹„êµ:**

| ì „ëµ | ì–´ë…¸í…Œì´ì…˜ ê°’ | íŠ¹ì§• | ì¥ì  | ë‹¨ì  |
|------|-------------|------|------|------|
| **ë‹¨ì¼ í…Œì´ë¸”** (ì„ íƒ) | `SINGLE_TABLE` | ëª¨ë“  ìì‹ ì»¬ëŸ¼ì„ í•˜ë‚˜ì˜ í…Œì´ë¸”ì— | JOIN ì—†ìŒ, ì„±ëŠ¥ ìµœê³ , ë‹¨ìˆœ | ìì‹ ì „ìš© ì»¬ëŸ¼ì€ NULL í—ˆìš©, í…Œì´ë¸”ì´ ì»¤ì§ˆ ìˆ˜ ìˆìŒ |
| **ì¡°ì¸** | `JOINED` | ë¶€ëª¨/ìì‹ í…Œì´ë¸” ë¶„ë¦¬ í›„ JOIN | ì •ê·œí™”, ì„œë¸Œíƒ€ì… ì»¬ëŸ¼ NOT NULL ê°€ëŠ¥ | JOINìœ¼ë¡œ ì„±ëŠ¥ ì €í•˜, ì¿¼ë¦¬ ë³µì¡ |
| **í´ë˜ìŠ¤ë³„ í…Œì´ë¸”** | `TABLE_PER_CLASS` | ê° ìì‹ë§ˆë‹¤ ë…ë¦½ í…Œì´ë¸” | NULL ì—†ìŒ | ê³µí†µ ì»¬ëŸ¼ ì¤‘ë³µ, ë¶€ëª¨ íƒ€ì… ì¡°íšŒ ì‹œ UNION í•„ìš”, ë¹„ì¶”ì²œ |

**ì´ ê°•ì˜ ì„ íƒ ì´ìœ **: ë‹¨ì¼ í…Œì´ë¸” ì „ëµì€ JOIN ì—†ì´ ë¹ ë¥´ê³  ë‹¨ìˆœí•©ë‹ˆë‹¤. Book/Album/Movieì˜ ì»¬ëŸ¼ì´ ë§ì§€ ì•Šì•„ í…Œì´ë¸”ì´ ì§€ë‚˜ì¹˜ê²Œ ë¹„ëŒ€í•´ì§€ì§€ ì•Šìœ¼ë¯€ë¡œ ì í•©í•©ë‹ˆë‹¤.

```
ITEM í…Œì´ë¸” (ë‹¨ì¼ í…Œì´ë¸” ì „ëµ):

ITEM_ID | DTYPE | NAME     | PRICE | STOCK | AUTHOR | ISBN | ARTIST | ETC | DIRECTOR | ACTOR
--------|-------|----------|-------|-------|--------|------|--------|-----|----------|------
1       | B     | JPAì±…    | 35000 | 10    | ê¹€ì˜í•œ  | 123  | NULL   | NULL| NULL    | NULL
2       | A     | BTSì•¨ë²”  | 25000 | 50    | NULL   | NULL | BTS    | ... | NULL    | NULL
3       | M     | ì–´ë²¤ì ¸ìŠ¤ | 15000 | 100   | NULL   | NULL | NULL   | NULL| ë£¨ì†Œ   | RDJ
```

### 5.6 Book / Album / Movie.java

**Book.java**

```java
package jpabook.jpashop.domain.Item;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;
import lombok.Getter;
import lombok.Setter;

@Entity
@DiscriminatorValue("B")
@Getter @Setter
public class Book extends Item {

    private String author;
    private String isbn;
}
```

**Album.java**

```java
package jpabook.jpashop.domain.Item;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;
import lombok.Getter;
import lombok.Setter;

@Entity
@DiscriminatorValue("A")
@Getter @Setter
public class Album extends Item {

    private String artist;
    private String etc;
}
```

**Movie.java**

```java
package jpabook.jpashop.domain.Item;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;
import lombok.Getter;
import lombok.Setter;

@Entity
@DiscriminatorValue("M")
@Getter @Setter
public class Movie extends Item {

    private String director;
    private String actor;
}
```

**í•µì‹¬ í¬ì¸íŠ¸:**

| ì–´ë…¸í…Œì´ì…˜ | ì„¤ëª… |
|-----------|------|
| `@DiscriminatorValue("B")` | ITEM í…Œì´ë¸”ì˜ `dtype` ì»¬ëŸ¼ì— ì €ì¥ë  ê°’. Bookì€ "B", Albumì€ "A", MovieëŠ” "M" |
| `extends Item` | ë¶€ëª¨ í´ë˜ìŠ¤(`Item`)ì˜ ê³µí†µ í•„ë“œ(`id`, `name`, `price`, `stockQuantity`)ë¥¼ ìƒì†ë°›ìŒ |
| ìì‹ í´ë˜ìŠ¤ ê³ ìœ  í•„ë“œ | Bookì˜ `author`/`isbn`, Albumì˜ `artist`/`etc`, Movieì˜ `director`/`actor` |

### 5.7 Delivery.java

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;

@Entity
@Getter @Setter
public class Delivery {

    @Id @GeneratedValue
    @Column(name = "delivery_id")
    private Long id;

    // Orderê°€ DELIVERY_ID FKë¥¼ ê°€ì§ â†’ Orderê°€ ì—°ê´€ê´€ê³„ ì£¼ì¸
    // DeliveryëŠ” ë¹„ì£¼ì¸: mappedBy = "delivery"
    @OneToOne(mappedBy = "delivery", fetch = FetchType.LAZY)
    private Order order;

    @Embedded
    private Address address;

    @Enumerated(EnumType.STRING)
    private DeliveryStatus status;  // READY, COMP
}
```

**í•µì‹¬ í¬ì¸íŠ¸:**

- 1:1 ê´€ê³„ì—ì„œ FKëŠ” ì£¼ë¡œ ì ‘ê·¼í•˜ëŠ” ìª½(Order)ì— ë°°ì¹˜ â†’ `Delivery`ëŠ” ë¹„ì£¼ì¸
- `mappedBy = "delivery"`: "ë‚˜ëŠ” Orderì˜ `delivery` í•„ë“œì— ì˜í•´ ë§¤í•‘ëœë‹¤"
- `@Embedded Address`: Memberì™€ ë§ˆì°¬ê°€ì§€ë¡œ `city`, `street`, `zipcode`ê°€ DELIVERY í…Œì´ë¸”ì— ì»¬ëŸ¼ìœ¼ë¡œ í¬í•¨ë¨
- `@Enumerated(EnumType.STRING)`: ORDINAL ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€

### 5.8 Order.java â€” Cascade + ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;

import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;

import static jakarta.persistence.FetchType.*;

@Entity
@Table(name = "orders")
@Getter @Setter
public class Order {

    @Id @GeneratedValue
    @Column(name = "order_id")
    private Long id;

    @ManyToOne(fetch = LAZY)
    @JoinColumn(name = "member_id")
    private Member member;

    // cascade: orderItemsì— ê°’ì„ ë‹´ì•„ë‘ê³  orderë¥¼ persistí•˜ë©´
    // orderItemsë„ ìë™ìœ¼ë¡œ í•¨ê»˜ persistë¨
    @OneToMany(mappedBy = "order", cascade = CascadeType.ALL)
    private List<OrderItem> orderItems = new ArrayList<>();

    // orderë¥¼ ì €ì¥í•  ë•Œ Deliveryë„ ìë™ìœ¼ë¡œ persist
    @OneToOne(fetch = LAZY, cascade = CascadeType.ALL)
    @JoinColumn(name = "delivery_id")
    private Delivery delivery;

    private LocalDateTime orderDate;

    @Enumerated(EnumType.STRING)
    private OrderStatus status;  // ì£¼ë¬¸ ìƒíƒœ [ORDER, CANCEL]

    // === ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ ===
    // í•µì‹¬ì ìœ¼ë¡œ ì»¨íŠ¸ë¡¤í•˜ëŠ” ìª½(Order)ì— ë°°ì¹˜
    public void setMember(Member member) {
        this.member = member;
        member.getOrders().add(this);  // ë°˜ëŒ€ìª½ë„ í•¨ê»˜ ì„¤ì •
    }

    public void addOrderItem(OrderItem orderItem) {
        orderItems.add(orderItem);
        orderItem.setOrder(this);      // ë°˜ëŒ€ìª½ë„ í•¨ê»˜ ì„¤ì •
    }

    public void setDelivery(Delivery delivery) {
        this.delivery = delivery;
        delivery.setOrder(this);       // ë°˜ëŒ€ìª½ë„ í•¨ê»˜ ì„¤ì •
    }
}
```

**Cascade ì„¤ëª…:**

```
[Cascade ì—†ì„ ë•Œ]
persist(orderItem1);   // ë”°ë¡œ ì €ì¥
persist(orderItem2);   // ë”°ë¡œ ì €ì¥
persist(orderItem3);   // ë”°ë¡œ ì €ì¥
persist(order);        // order ì €ì¥ â†’ ì´ 4ë²ˆì˜ persist í•„ìš”

[Cascade ìˆì„ ë•Œ]
order.getOrderItems().add(orderItem1);
order.getOrderItems().add(orderItem2);
order.getOrderItems().add(orderItem3);
persist(order);        // order í•˜ë‚˜ë§Œ persist â†’ orderItems, deliveryë„ ìë™ ì €ì¥
```

**ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ ë™ì‘ ë°©ì‹:**

```java
// í¸ì˜ ë©”ì„œë“œ ì—†ì´ ì–‘ìª½ì„ ì§ì ‘ ì„¤ì •í•˜ëŠ” ê²½ìš° (ë¶ˆí¸í•˜ê³  ì‹¤ìˆ˜ ìœ„í—˜)
order.setMember(member);           // Order â†’ Member ì„¤ì •
member.getOrders().add(order);     // Member â†’ Order ì„¤ì • (ë¹ ëœ¨ë¦¬ê¸° ì‰¬ì›€)

// í¸ì˜ ë©”ì„œë“œ ì‚¬ìš© (í•œ ë²ˆë§Œ í˜¸ì¶œí•˜ë©´ ì–‘ìª½ ëª¨ë‘ ì„¤ì •ë¨)
order.setMember(member);           // ë‚´ë¶€ì—ì„œ member.getOrders().add(this)ë„ í•¨ê»˜ ì‹¤í–‰
```

### 5.9 OrderItem.java

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import jpabook.jpashop.domain.Item.Item;
import lombok.Getter;
import lombok.Setter;

@Entity
@Getter @Setter
public class OrderItem {

    @Id @GeneratedValue
    @Column(name = "order_item_id")
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "item_id")
    private Item item;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "order_id")
    private Order order;

    private int orderPrice;  // ì£¼ë¬¸ ê°€ê²© (ì£¼ë¬¸ ë‹¹ì‹œì˜ ê°€ê²© ìŠ¤ëƒ…ìƒ·)
    private int count;       // ì£¼ë¬¸ ìˆ˜ëŸ‰
}
```

**í•µì‹¬ í¬ì¸íŠ¸:**

- `orderPrice`ë¥¼ ë³„ë„ í•„ë“œë¡œ ì €ì¥í•˜ëŠ” ì´ìœ : ìƒí’ˆì˜ ê°€ê²©ì€ ë‚˜ì¤‘ì— ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, **ì£¼ë¬¸ ë‹¹ì‹œì˜ ê°€ê²©ì„ ìŠ¤ëƒ…ìƒ·ìœ¼ë¡œ ë³´ê´€**
- `Item`ì„ ì§ì ‘ ê°€ì§€ë˜ ë‹¨ë°©í–¥ (`Item`ì—ì„œ `OrderItem` ëª©ë¡ ì¡°íšŒ ë¶ˆí•„ìš”)
- ë‘ `@ManyToOne` ëª¨ë‘ `LAZY` ë¡œë”© ì„¤ì •

### 5.10 Category.java â€” M:N + ìê¸°ì°¸ì¡° + í¸ì˜ ë©”ì„œë“œ

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import jpabook.jpashop.domain.Item.Item;
import lombok.Getter;
import lombok.Setter;

import java.util.ArrayList;
import java.util.List;

import static jakarta.persistence.FetchType.*;

@Entity
@Getter @Setter
public class Category {

    @Id @GeneratedValue
    @Column(name = "category_id")
    private Long id;

    private String name;

    // M:N â€” ì—°ê´€ê´€ê³„ ì£¼ì¸
    // joinColumns: í˜„ì¬ ì—”í‹°í‹°(Category)ê°€ ì¤‘ê°„ í…Œì´ë¸”ì— ì—°ê²°ë˜ëŠ” FK
    // inverseJoinColumns: ë°˜ëŒ€ìª½ ì—”í‹°í‹°(Item)ê°€ ì¤‘ê°„ í…Œì´ë¸”ì— ì—°ê²°ë˜ëŠ” FK
    @ManyToMany
    @JoinTable(name = "category_item",
            joinColumns = @JoinColumn(name = "category_id"),
            inverseJoinColumns = @JoinColumn(name = "item_id"))
    private List<Item> items = new ArrayList<>();

    // ìê¸°ì°¸ì¡° â€” ë¶€ëª¨ ì¹´í…Œê³ ë¦¬ (ì£¼ì¸)
    @ManyToOne(fetch = LAZY)
    @JoinColumn(name = "parent_id")
    private Category parent;

    // ìê¸°ì°¸ì¡° â€” ìì‹ ì¹´í…Œê³ ë¦¬ ëª©ë¡ (ë¹„ì£¼ì¸)
    @OneToMany(mappedBy = "parent")
    private List<Category> child = new ArrayList<>();

    // === ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ ===
    public void addChildCategory(Category child) {
        this.child.add(child);
        child.setParent(this);
    }
}
```

**`@JoinTable` ìƒì„¸ ì„¤ëª…:**

```
@JoinTable(
    name = "category_item",                           â† ì¤‘ê°„ ì¡°ì¸ í…Œì´ë¸” ì´ë¦„
    joinColumns = @JoinColumn(name = "category_id"),  â† í˜„ì¬ ì—”í‹°í‹°(Category) FK
    inverseJoinColumns = @JoinColumn(name = "item_id") â† ìƒëŒ€ ì—”í‹°í‹°(Item) FK
)

ìƒì„±ë˜ëŠ” CATEGORY_ITEM í…Œì´ë¸”:
CATEGORY_ID (FK â†’ CATEGORY.CATEGORY_ID)
ITEM_ID     (FK â†’ ITEM.ITEM_ID)
```

**ìê¸°ì°¸ì¡° íŠ¸ë¦¬ êµ¬ì¡°:**

```
CATEGORY_ID   NAME        PARENT_ID
1             ì „ì²´         NULL
2             ìŒì‹         1
3             í•œì‹         2
4             ì¤‘ì‹         2
5             ì „ìì œí’ˆ      1
6             ê°€ì „          5

ê°ì²´ë¡œ í‘œí˜„í•˜ë©´:
ì „ì²´(id=1)
â”œâ”€â”€ ìŒì‹(id=2)
â”‚   â”œâ”€â”€ í•œì‹(id=3)
â”‚   â””â”€â”€ ì¤‘ì‹(id=4)
â””â”€â”€ ì „ìì œí’ˆ(id=5)
    â””â”€â”€ ê°€ì „(id=6)
```

**`addChildCategory` í¸ì˜ ë©”ì„œë“œ:**

```java
// ì‚¬ìš© ì˜ˆì‹œ
Category food = new Category();
Category korean = new Category();

food.addChildCategory(korean);
// ë‚´ë¶€ì—ì„œ food.child.add(korean)ê³¼ korean.setParent(food)ê°€ ë™ì‹œì— ì‹¤í–‰ë¨
```

---

## 6. ì„¤ê³„ í•µì‹¬ ì£¼ì˜ì  ë° êµ¬í˜„ ì‹œ ì£¼ì˜ì 

### 6.1 @ManyToMany ì‚¬ìš©ì„ ì§€ì–‘í•´ì•¼ í•˜ëŠ” ì´ìœ 

`@ManyToMany`ëŠ” JPAê°€ ì œê³µí•˜ëŠ” í¸ë¦¬í•œ ê¸°ëŠ¥ì´ì§€ë§Œ, **ì‹¤ë¬´ì—ì„œëŠ” ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

**ë¬¸ì œì :**

```
@ManyToManyë¡œ ìƒì„±ë˜ëŠ” CATEGORY_ITEM í…Œì´ë¸”:

CATEGORY_ID (PK, FK)
ITEM_ID     (PK, FK)

â†’ ì˜¤ì§ ë‘ FK ì»¬ëŸ¼ë§Œ ì¡´ì¬!
â†’ ì‹¤ë¬´ì—ì„œëŠ” ì¤‘ê°„ í…Œì´ë¸”ì— ì¶”ê°€ ì»¬ëŸ¼ì´ í•„ìš”í•œ ê²½ìš°ê°€ ë§ìŒ
  ì˜ˆ) ë“±ë¡ì¼, ë“±ë¡ì, ë©”ëª¨ ë“±
â†’ @ManyToManyëŠ” ì¶”ê°€ ì»¬ëŸ¼ì„ ë„£ì„ ìˆ˜ ì—†ìŒ!
â†’ ê²°êµ­ ë‚˜ì¤‘ì— ì¤‘ê°„ ì—”í‹°í‹°ë¡œ ë°”ê¿”ì•¼ í•˜ëŠ” ìƒí™© ë°œìƒ
```

**ê¶Œì¥ íŒ¨í„´ - ì¤‘ê°„ ì—”í‹°í‹° ì‚¬ìš©:**

```
[ë¹„ê¶Œì¥] @ManyToMany
Item â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Category
     (CATEGORY_ITEM ìë™ ìƒì„±)
     (ì¶”ê°€ ì»¬ëŸ¼ ë¶ˆê°€)

[ê¶Œì¥] ì¤‘ê°„ ì—”í‹°í‹°
Item â”€â”€â”€ CategoryItem â”€â”€â”€ Category
         (ì¶”ê°€ ì»¬ëŸ¼ ê°€ëŠ¥)
         id: Long
         item: Item
         category: Category
         createdAt: LocalDateTime   â† ì¶”ê°€ ì»¬ëŸ¼ ììœ ë¡­ê²Œ ì¶”ê°€ ê°€ëŠ¥
```

```java
// âŒ ì•ˆí‹°íŒ¨í„´
@ManyToMany
@JoinTable(name = "CATEGORY_ITEM", ...)
private List<Item> items;

// âœ… ê¶Œì¥ íŒ¨í„´ (ì´ ê°•ì˜ì—ì„œëŠ” í•™ìŠµ ëª©ì ìœ¼ë¡œ @ManyToMany ì‚¬ìš©)
@Entity
public class CategoryItem {
    @Id @GeneratedValue
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "CATEGORY_ID")
    private Category category;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "ITEM_ID")
    private Item item;

    // í•„ìš”í•œ ì»¬ëŸ¼ ììœ ë¡­ê²Œ ì¶”ê°€ ê°€ëŠ¥
    private LocalDateTime createdAt;
}
```

### 6.2 ê°’ íƒ€ì… (@Embeddable) Addressì˜ ê°œë…

**AddressëŠ” ì™œ ì—”í‹°í‹°ê°€ ì•„ë‹Œ ê°’ íƒ€ì…ì¸ê°€?**

```
[ì—”í‹°í‹°ë¡œ ì„¤ê³„í•  ê²½ìš°ì˜ ë¬¸ì œ]
Member.address = Address (id=1)
Delivery.address = Address (id=2)
â†’ ê°ì ë‹¤ë¥¸ DB í–‰ì´ í•„ìš”, ë¶ˆí•„ìš”í•œ ì¡°ì¸ ë°œìƒ

[ê°’ íƒ€ì…ìœ¼ë¡œ ì„¤ê³„]
Member   í…Œì´ë¸”: CITY, STREET, ZIPCODE ì»¬ëŸ¼ ì§ì ‘ í¬í•¨
Delivery í…Œì´ë¸”: CITY, STREET, ZIPCODE ì»¬ëŸ¼ ì§ì ‘ í¬í•¨
â†’ ì¡°ì¸ ì—†ìŒ, ê°„ë‹¨í•˜ê³  íš¨ìœ¨ì 
```

**ê°’ íƒ€ì… ì‚¬ìš© ì‹œ í•µì‹¬ ì£¼ì˜ì‚¬í•­:**

```java
// âŒ ìœ„í—˜ - ê°™ì€ Address ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³µìœ í•˜ë©´ ì•ˆ ë¨!
Address address = new Address("Seoul", "Gangnam", "12345");
member.setAddress(address);
delivery.setAddress(address);  // ê°™ì€ ê°ì²´ ê³µìœ 

// ë‚˜ì¤‘ì—:
address.setCity("Busan");  // memberì™€ delivery ëª¨ë‘ ì˜í–¥ ë°›ìŒ! ì‚¬ì´ë“œ ì´í™íŠ¸!

// âœ… ì•ˆì „ - ê°’ íƒ€ì…ì€ ë¶ˆë³€(Immutable)ìœ¼ë¡œ ë§Œë“¤ì–´ì•¼ í•¨
@Embeddable
public class Address {
    private String city;
    private String street;
    private String zipcode;

    // ìƒì„±ìë¡œë§Œ ê°’ ì„¤ì • (setter ê¸ˆì§€)
    protected Address() {} // JPA ê¸°ë³¸ ìƒì„±ì

    public Address(String city, String street, String zipcode) {
        this.city = city;
        this.street = street;
        this.zipcode = zipcode;
    }
    // getterë§Œ ì œê³µ, setter ì—†ìŒ
}
```

### 6.3 ì™¸ë˜ í‚¤ ìœ„ì¹˜ ê²°ì • ê¸°ì¤€ (ì—°ê´€ê´€ê³„ ì£¼ì¸ ì„ íƒ)

**ì›ì¹™: FKê°€ ìˆëŠ” í…Œì´ë¸”ì˜ ì—”í‹°í‹°ê°€ ì—°ê´€ê´€ê³„ ì£¼ì¸**

```
[1:N ê´€ê³„]
"N" ìª½ì´ í•­ìƒ FKë¥¼ ê°€ì§ â†’ "N" ìª½ì´ ì£¼ì¸

Member(1) : Order(N) â†’ Orderê°€ MEMBER_ID FK ê°€ì§ â†’ Orderê°€ ì£¼ì¸
Order(1) : OrderItem(N) â†’ OrderItemì´ ORDER_ID FK ê°€ì§ â†’ OrderItemì´ ì£¼ì¸

[1:1 ê´€ê³„]
ì–´ëŠ ìª½ì— FKë¥¼ ë‘˜ì§€ ì„ íƒí•´ì•¼ í•¨ â†’ ì£¼ë¡œ ì ‘ê·¼í•˜ëŠ” ìª½(ì£¼ í…Œì´ë¸”)ì— FK ë°°ì¹˜
Order : Delivery â†’ Orderê°€ DELIVERY_ID FK ê°€ì§ â†’ Orderê°€ ì£¼ì¸

[M:N ê´€ê³„]
ì¡°ì¸ í…Œì´ë¸”ì´ ì–‘ìª½ FKë¥¼ ëª¨ë‘ ê°€ì§
```

**ë¹„ì£¼ì¸ ìª½ì—ì„œ ê°’ì„ ë³€ê²½í•˜ë©´?**

```java
// ì˜ˆì‹œ: ì£¼ì¸ì´ ì•„ë‹Œ Memberì—ì„œ Orderë¥¼ ì¶”ê°€í•˜ëŠ” ê²½ìš°
member.getOrders().add(order);  // Member.ordersì— ì¶”ê°€ (ë¹„ì£¼ì¸!)

// JPAëŠ” ì´ ë³€ê²½ì„ DBì— ë°˜ì˜í•˜ì§€ ì•ŠìŒ!
// Order í…Œì´ë¸”ì˜ MEMBER_IDëŠ” ë³€ê²½ë˜ì§€ ì•ŠìŒ

// âœ… ë°˜ë“œì‹œ ì£¼ì¸ ìª½ì—ì„œ ì„¤ì •
order.setMember(member);  // Order.member ì„¤ì • (ì£¼ì¸!) â†’ MEMBER_ID ì—…ë°ì´íŠ¸
```

**ê´€ë¡€: ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ ì‘ì„±**

```java
// Order (ì£¼ì¸) - ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ ì˜ˆì‹œ
public void setMember(Member member) {
    this.member = member;
    member.getOrders().add(this);  // ë°˜ëŒ€ìª½ë„ í•¨ê»˜ ì„¤ì • (ê°ì²´ ë™ê¸°í™”)
}
```

### 6.4 ë‹¨ë°©í–¥ vs ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì„ íƒ ê¸°ì¤€

```
[ì›ì¹™]
ê¸°ë³¸ì€ ë‹¨ë°©í–¥ìœ¼ë¡œ ì„¤ê³„í•˜ê³ ,
ì—­ë°©í–¥ ì¡°íšŒê°€ ì‹¤ì œë¡œ í•„ìš”í•  ë•Œë§Œ ì–‘ë°©í–¥ìœ¼ë¡œ í™•ì¥

[ë‹¨ë°©í–¥ìœ¼ë¡œ ì¶©ë¶„í•œ ê²½ìš°]
OrderItem â†’ Item: Itemì—ì„œ OrderItem ëª©ë¡ì„ ì¡°íšŒí•  ì¼ì´ ê±°ì˜ ì—†ìŒ
â†’ ë‹¨ë°©í–¥ìœ¼ë¡œ ìœ ì§€

[ì–‘ë°©í–¥ì´ í•„ìš”í•œ ê²½ìš°]
Order â†” OrderItem: ì£¼ë¬¸ì„œë¥¼ ì¡°íšŒí•˜ë©´ ì£¼ë¬¸ ìƒí’ˆ ëª©ë¡ì´ ë°˜ë“œì‹œ í•„ìš”
â†’ ì–‘ë°©í–¥ ì„¤ì • (Order.orderItems)
```

**ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì£¼ì˜ì‚¬í•­:**

| í•­ëª© | ì„¤ëª… |
|------|------|
| **ë¬´í•œ ë£¨í”„** | `toString()`, `JSON ì§ë ¬í™”` ì‹œ ì–‘ë°©í–¥ ì°¸ì¡°ë¡œ ë¬´í•œ ë£¨í”„ ë°œìƒ ê°€ëŠ¥ |
| **í…Œì´ë¸” ì¦ê°€ ì—†ìŒ** | ì–‘ë°©í–¥ ì¶”ê°€í•´ë„ í…Œì´ë¸” ë³€ê²½ ì—†ìŒ (ê°ì²´ ê·¸ë˜í”„ë§Œ ì¶”ê°€ë¨) |
| **Lombok @Data ê¸ˆì§€** | `@EqualsAndHashCode`ê°€ ì–‘ë°©í–¥ ì°¸ì¡°ì—ì„œ ë¬´í•œ ë£¨í”„ ìœ ë°œ |

### 6.5 GetterëŠ” ì—´ì–´ë‘ê³ , SetterëŠ” ê¼­ í•„ìš”í•œ ê²½ìš°ì—ë§Œ

**Getter**ë¥¼ ëª¨ë‘ ì—´ì–´ë‘ëŠ” ì´ìœ :
- GetterëŠ” ë‹¨ìˆœíˆ ê°’ì„ ì½ê¸°ë§Œ í•˜ë¯€ë¡œ ì–´ë””ì„œ í˜¸ì¶œí•´ë„ **ë¶€ì‘ìš©(side effect)ì´ ì—†ìŒ**

**Setterë¥¼ ì œí•œí•´ì•¼ í•˜ëŠ” ì´ìœ :**
- Setterë¥¼ ì—´ì–´ë‘ë©´ ê°’ì´ ë³€ê²½ë˜ëŠ” ì‹œì ì´ ë„ˆë¬´ ë§ì•„ì§
- ë‚˜ì¤‘ì— ë°ì´í„°ê°€ ì™œ ë°”ë€Œì—ˆëŠ”ì§€ ì¶”ì ì´ ì–´ë ¤ì›Œì§
- ë²„ê·¸ ë°œìƒ ì‹œ ì›ì¸ íŒŒì•…ì´ í˜ë“¤ì–´ì§

```java
// âŒ ë¬¸ì œ ìˆëŠ” ë°©ì‹ - setterë¡œ ê°’ ë³€ê²½
order.setStatus(OrderStatus.CANCEL);
order.setOrderDate(LocalDateTime.now());

// âœ… ê¶Œì¥ ë°©ì‹ - ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œë¡œ ì˜ë„ë¥¼ ëª…í™•íˆ í‘œí˜„
public void cancel() {
    if (delivery.getStatus() == DeliveryStatus.COMP) {
        throw new IllegalStateException("ì´ë¯¸ ë°°ì†¡ì™„ë£Œëœ ìƒí’ˆì€ ì·¨ì†Œê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.");
    }
    this.status = OrderStatus.CANCEL;
    // ì·¨ì†Œ ì‹œ ì¬ê³  ë³µêµ¬ ë¡œì§ë„ í•¨ê»˜ ì²˜ë¦¬
}
```

**ì´ ê°•ì˜ì˜ ë°©ì¹¨**: ì„¤ëª… í¸ì˜ë¥¼ ìœ„í•´ `@Getter @Setter` ëª¨ë‘ ì—´ì–´ë‘ë˜, ì´í›„ ì±•í„°ì—ì„œ ì„œë¹„ìŠ¤ ê³„ì¸µì„ êµ¬í˜„í•˜ë©´ì„œ ì ì§„ì ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.

### 6.6 ëª¨ë“  ì—°ê´€ê´€ê³„ëŠ” LAZY ë¡œë”©

**ì¦‰ì‹œ ë¡œë”©(EAGER)ì´ ë¬¸ì œì¸ ì´ìœ :**

```
[EAGER ë¡œë”© ì˜ˆì‹œ]
Order 100ê°œë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ 1ë²ˆ
+ ê° Orderì˜ Memberë¥¼ EAGERë¡œ ì¦‰ì‹œ ë¡œë”© â†’ Member SELECT 100ë²ˆ
= ì´ 101ë²ˆ ì¿¼ë¦¬ ë°œìƒ! â†’ N+1 ë¬¸ì œ
```

**LAZY ë¡œë”©ì´ ì˜¬ë°”ë¥¸ ì´ìœ :**

```
[LAZY ë¡œë”©]
Order 100ê°œë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ 1ë²ˆ
â†’ memberëŠ” í”„ë¡ì‹œ ê°ì²´ë¡œ ëŒ€ì²´
â†’ ì‹¤ì œ member.getName() í˜¸ì¶œ ì‹œì ì—ë§Œ SELECT ì‹¤í–‰

â†’ í•„ìš”í•œ ì—°ê´€ ì—”í‹°í‹°ë§Œ ì¡°íšŒ â†’ ì„±ëŠ¥ ìµœì í™” ê°€ëŠ¥
â†’ í•„ìš” ì‹œ fetch joinìœ¼ë¡œ í•œ ë²ˆì— ì¡°íšŒ ê°€ëŠ¥
```

**JPA ê¸°ë³¸ê°’ ì£¼ì˜:**

| ì–´ë…¸í…Œì´ì…˜ | ê¸°ë³¸ Fetch ì „ëµ | ê¶Œì¥ ì„¤ì • |
|-----------|---------------|----------|
| `@ManyToOne` | `EAGER` (ì¦‰ì‹œ ë¡œë”©) | `LAZY`ë¡œ ë³€ê²½ í•„ìˆ˜ |
| `@OneToOne` | `EAGER` (ì¦‰ì‹œ ë¡œë”©) | `LAZY`ë¡œ ë³€ê²½ í•„ìˆ˜ |
| `@OneToMany` | `LAZY` (ì§€ì—° ë¡œë”©) | ê¸°ë³¸ê°’ ìœ ì§€ |
| `@ManyToMany` | `LAZY` (ì§€ì—° ë¡œë”©) | ê¸°ë³¸ê°’ ìœ ì§€ |

```java
// âŒ ê¸°ë³¸ê°’ EAGER ê·¸ëŒ€ë¡œ ì‚¬ìš© (ì ˆëŒ€ ê¸ˆì§€)
@ManyToOne
@JoinColumn(name = "member_id")
private Member member;

// âœ… ë°˜ë“œì‹œ LAZYë¡œ ëª…ì‹œ
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "member_id")
private Member member;
```

### 6.7 Cascade ì„¤ì • ì „ëµ

**Cascadeë¥¼ ì ìš©í•˜ë©´ ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ ì €ì¥/ì‚­ì œí•  ë•Œ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì²˜ë¦¬ë©ë‹ˆë‹¤.**

**Cascade ì ìš© ê¸°ì¤€:**

| ê¸°ì¤€ | ì„¤ëª… |
|------|------|
| âœ… ìƒëª…ì£¼ê¸°ê°€ **ê°™ì€** ì—”í‹°í‹°ë¼ë¦¬ | Orderì™€ OrderItemì€ í•¨ê»˜ ìƒì„±/ì‚­ì œë¨ |
| âœ… ì†Œìœ ìê°€ **í•˜ë‚˜**ì¸ ì—”í‹°í‹° | OrderItemì€ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ Orderì—ë§Œ ì†í•¨ |
| âŒ ì—¬ëŸ¬ ê³³ì—ì„œ **ì°¸ì¡°í•˜ëŠ”** ì—”í‹°í‹° | Itemì€ ì—¬ëŸ¬ OrderItemì´ ì°¸ì¡° â†’ Cascade ë¶ˆê°€ |

```java
// âœ… ì ì ˆí•œ Cascade ì ìš©
@OneToMany(mappedBy = "order", cascade = CascadeType.ALL)
private List<OrderItem> orderItems = new ArrayList<>();
// Order ì €ì¥ ì‹œ OrderItemë„ ìë™ ì €ì¥, Order ì‚­ì œ ì‹œ OrderItemë„ ìë™ ì‚­ì œ

@OneToOne(fetch = LAZY, cascade = CascadeType.ALL)
@JoinColumn(name = "delivery_id")
private Delivery delivery;
// Order ì €ì¥ ì‹œ Deliveryë„ ìë™ ì €ì¥

// âŒ ë¶€ì ì ˆí•œ Cascade ì˜ˆì‹œ (ì ìš©í•˜ë©´ ì•ˆ ë¨)
// OrderItemì—ì„œ Itemì— Cascadeë¥¼ ê±¸ë©´:
// â†’ Order ì‚­ì œ ì‹œ Itemê¹Œì§€ ì‚­ì œë¨
// â†’ ë‹¤ë¥¸ OrderItemì´ ì°¸ì¡°í•˜ë˜ Itemë„ ì‚­ì œë˜ì–´ ë°ì´í„° ì˜¤ì—¼!
```

### 6.8 ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ

ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ê°€ ìˆì„ ë•Œ ì–‘ìª½ ê°ì²´ë¥¼ ëª¨ë‘ ì„¤ì •í•´ ì£¼ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤.

**ë°°ì¹˜ ìœ„ì¹˜ ê¸°ì¤€:** "í•µì‹¬ì ìœ¼ë¡œ ì»¨íŠ¸ë¡¤í•˜ëŠ” ìª½"ì— ë°°ì¹˜

```java
// Order.java â€” 3ê°œì˜ í¸ì˜ ë©”ì„œë“œ ë³´ìœ 

// Member â†” Order ì–‘ë°©í–¥ ì„¤ì •
public void setMember(Member member) {
    this.member = member;           // Order â†’ Member ì„¤ì • (ì£¼ì¸)
    member.getOrders().add(this);  // Member â†’ Order ì„¤ì • (ë™ê¸°í™”)
}

// Order â†” OrderItem ì–‘ë°©í–¥ ì„¤ì •
public void addOrderItem(OrderItem orderItem) {
    orderItems.add(orderItem);       // Order â†’ OrderItem ì„¤ì • (ë¹„ì£¼ì¸)
    orderItem.setOrder(this);        // OrderItem â†’ Order ì„¤ì • (ì£¼ì¸)
}

// Order â†” Delivery ì–‘ë°©í–¥ ì„¤ì •
public void setDelivery(Delivery delivery) {
    this.delivery = delivery;        // Order â†’ Delivery ì„¤ì • (ì£¼ì¸)
    delivery.setOrder(this);         // Delivery â†’ Order ì„¤ì • (ë™ê¸°í™”)
}

// Category.java â€” 1ê°œì˜ í¸ì˜ ë©”ì„œë“œ ë³´ìœ 

// Category ìê¸°ì°¸ì¡° ì–‘ë°©í–¥ ì„¤ì •
public void addChildCategory(Category child) {
    this.child.add(child);           // ë¶€ëª¨ â†’ ìì‹ ì„¤ì • (ë¹„ì£¼ì¸)
    child.setParent(this);           // ìì‹ â†’ ë¶€ëª¨ ì„¤ì • (ì£¼ì¸)
}
```

### 6.9 ì»¬ë ‰ì…˜ì€ í•„ë“œì—ì„œ ì´ˆê¸°í™”

í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥í•˜ë©´ ì»¬ë ‰ì…˜ì„ ìì²´ êµ¬í˜„ì²´(`PersistentBag` ë“±)ë¡œ ë˜í•‘í•©ë‹ˆë‹¤. ì´ ë˜í•‘ì´ í’€ë¦¬ë©´ í•˜ì´ë²„ë„¤ì´íŠ¸ ë‚´ë¶€ ë©”ì»¤ë‹ˆì¦˜ì´ ì†ìƒë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
// í•˜ì´ë²„ë„¤ì´íŠ¸ì˜ ì»¬ë ‰ì…˜ ë˜í•‘ ì˜ˆì‹œ
Member member = new Member();
System.out.println(member.getOrders().getClass());
// â†’ class java.util.ArrayList   (ì €ì¥ ì „)

em.persist(member);

System.out.println(member.getOrders().getClass());
// â†’ class org.hibernate.collection.internal.PersistentBag   (ì €ì¥ í›„, ë˜í•‘ë¨)
```

**í•„ë“œì—ì„œ ì´ˆê¸°í™”í•´ì•¼ í•˜ëŠ” ì´ìœ :**

```java
// âŒ ìœ„í—˜ - ìƒì„±ìì—ì„œ ì´ˆê¸°í™” í›„ setterë¡œ êµì²´í•˜ë©´ ë˜í•‘ì´ í’€ë¦¼
public class Member {
    private List<Order> orders;

    public Member() {
        orders = new ArrayList<>();  // ìƒì„±ìì—ì„œ ì´ˆê¸°í™”
    }

    public void setOrders(List<Order> orders) {
        this.orders = orders;  // setterë¡œ êµì²´í•˜ë©´ ê¸°ì¡´ ë˜í•‘ì´ í’€ë ¤ë²„ë¦¼!
    }
}

// âœ… ì•ˆì „ - í•„ë“œì—ì„œ ë°”ë¡œ ì´ˆê¸°í™”
public class Member {
    @OneToMany(mappedBy = "member")
    private List<Order> orders = new ArrayList<>();  // í•„ë“œ ì´ˆê¸°í™”
    // â†’ ì ˆëŒ€ êµì²´í•˜ì§€ ì•ŠìŒ â†’ ë˜í•‘ ìƒíƒœ ìœ ì§€
}
```

**ê²°ë¡ **: ì»¬ë ‰ì…˜ì€ í•­ìƒ `= new ArrayList<>()` í˜•íƒœë¡œ í•„ë“œ ì„ ì–¸ ì‹œì ì— ì´ˆê¸°í™”í•˜ê³ , setterë¡œ êµì²´í•˜ì§€ ë§ˆì„¸ìš”.

### 6.10 í…Œì´ë¸”, ì»¬ëŸ¼ëª… ìƒì„± ì „ëµ (SpringPhysicalNamingStrategy)

ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì—”í‹°í‹° í•„ë“œëª…ì„ DB ì»¬ëŸ¼ëª…ìœ¼ë¡œ ìë™ ë³€í™˜í•  ë•Œ **ë„¤ì´ë° ì „ëµ**ì„ ì ìš©í•©ë‹ˆë‹¤.

**ìŠ¤í”„ë§ ë¶€íŠ¸ ë„¤ì´ë° ì „ëµ 3ê°€ì§€ ê·œì¹™:**

| ê·œì¹™ | ì˜ˆì‹œ |
|------|------|
| ì¹´ë©œ ì¼€ì´ìŠ¤ â†’ ì–¸ë”ìŠ¤ì½”ì–´ | `memberPoint` â†’ `member_point` |
| `.`(ì ) â†’ `_`(ì–¸ë”ìŠ¤ì½”ì–´) | `address.city` â†’ `address_city` |
| ëŒ€ë¬¸ì â†’ ì†Œë¬¸ì | `MEMBER_ID` â†’ `member_id` |

**ì ìš© 2ë‹¨ê³„:**

```
1ë‹¨ê³„ - ë…¼ë¦¬ëª… ìƒì„± (ImplicitNamingStrategy)
  â†’ @Column ë“±ì—ì„œ ëª…ì‹œì ì¸ ì´ë¦„ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ìë™ ìƒì„±
  â†’ ì˜ˆ) private String memberPoint â†’ ë…¼ë¦¬ëª… "memberPoint"

2ë‹¨ê³„ - ë¬¼ë¦¬ëª… ì ìš© (SpringPhysicalNamingStrategy)
  â†’ ë…¼ë¦¬ëª…ì— ìœ„ì˜ 3ê°€ì§€ ê·œì¹™ì„ ì ìš©í•´ ì‹¤ì œ DB ì»¬ëŸ¼ëª… ê²°ì •
  â†’ ì˜ˆ) "memberPoint" â†’ "member_point"
  â†’ ëª¨ë“  ë…¼ë¦¬ëª…ì— ì¼ê´„ ì ìš© (íšŒì‚¬ ê·œì¹™ìœ¼ë¡œ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ ê°€ëŠ¥)
```

**ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ë³¸ ì„¤ì •ê°’ (application.properties):**

```properties
spring.jpa.hibernate.naming.implicit-strategy=
  org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy

spring.jpa.hibernate.naming.physical-strategy=
  org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy
```

**ì‹¤ì œ ì ìš© ì˜ˆì‹œ:**

```java
// ì—”í‹°í‹° í•„ë“œ
private String orderDate;      // â†’ order_date
private int stockQuantity;     // â†’ stock_quantity
private Long memberId;         // â†’ member_id

// @Columnìœ¼ë¡œ ëª…ì‹œí•œ ê²½ìš° ë…¼ë¦¬ëª…ìœ¼ë¡œ ì‚¬ìš©ë¨ (ë¬¼ë¦¬ëª… ë³€í™˜ ì ìš©)
@Column(name = "member_id")    // â†’ member_id (ì†Œë¬¸ì ë³€í™˜ ì ìš©)
private Long id;
```

> **ì°¸ê³ **: ìë™ ìƒì„±ëœ DDL ìŠ¤í¬ë¦½íŠ¸ëŠ” ì°¸ê³ ìš©ìœ¼ë¡œë§Œ í™œìš©í•˜ê³ , ë°˜ë“œì‹œ ê²€í† Â·ë‹¤ë“¬ì–´ì„œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. í”„ë¡œë•ì…˜ì—ì„œ `ddl-auto=create`ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ì¡´ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.

---

## 7. ë¶€ë¡

### 7.1 í•µì‹¬ ìš©ì–´ ì •ë¦¬

| ìš©ì–´ | ì„¤ëª… |
|------|------|
| **ë„ë©”ì¸ ëª¨ë¸** | ë¹„ì¦ˆë‹ˆìŠ¤ ê°œë…ì„ ê°ì²´ë¡œ í‘œí˜„í•œ ì„¤ê³„ë„ (í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨) |
| **ERD** | Entity-Relationship Diagram. í…Œì´ë¸” ê°„ì˜ ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” DB ì„¤ê³„ë„ |
| **ì—”í‹°í‹°(Entity)** | DB í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ëŠ” Java í´ë˜ìŠ¤ (`@Entity`) |
| **ê°’ íƒ€ì…(Value Type)** | ì‹ë³„ì ì—†ì´ ì†Œìœ  ì—”í‹°í‹°ì— ì¢…ì†ë˜ëŠ” ë°ì´í„° (`@Embeddable`) |
| **ì—°ê´€ê´€ê³„ ì£¼ì¸(Owner)** | FKë¥¼ ì‹¤ì œë¡œ ê´€ë¦¬í•˜ëŠ” ìª½. ì´ ìª½ì˜ ë³€ê²½ë§Œ DBì— ë°˜ì˜ë¨ |
| **mappedBy** | ë¹„ì£¼ì¸ ìª½ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì†ì„±. "ë‚˜ëŠ” ì´ í•„ë“œì— ì˜í•´ ë§¤í•‘ëœë‹¤"ëŠ” ì˜ë¯¸ |
| **ì¡°ì¸ í…Œì´ë¸”** | M:N ê´€ê³„ì—ì„œ ë‘ í…Œì´ë¸”ì˜ FKë¥¼ ëª¨ì•„ë†“ì€ ì¤‘ê°„ í…Œì´ë¸” |
| **ë‹¨ì¼ í…Œì´ë¸” ì „ëµ** | ìƒì† ê´€ê³„ë¥¼ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ í‘œí˜„. `DTYPE` ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ë¶„ |
| **ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸** | JPAê°€ ì—”í‹°í‹°ë¥¼ ê´€ë¦¬í•˜ëŠ” 1ì°¨ ìºì‹œ ê³µê°„ |
| **íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜** | ê°ì²´ ì§€í–¥(ì°¸ì¡°)ê³¼ ê´€ê³„í˜• DB(FK) ì‚¬ì´ì˜ ì°¨ì´. JPAê°€ í•´ê²° |
| **Cascade** | ë¶€ëª¨ ì—”í‹°í‹°ì˜ ìƒíƒœ ë³€í™”ë¥¼ ìì‹ ì—”í‹°í‹°ì— ìë™ ì „íŒŒ |
| **LAZY ë¡œë”©** | ì—°ê´€ ì—”í‹°í‹°ë¥¼ ì‹¤ì œ ì‚¬ìš© ì‹œì ì— ì¿¼ë¦¬í•˜ëŠ” ì „ëµ |
| **PersistentBag** | í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì»¬ë ‰ì…˜ì„ ë˜í•‘í•˜ëŠ” ìì²´ êµ¬í˜„ì²´ |
| **ë„¤ì´ë° ì „ëµ** | ì—”í‹°í‹° í•„ë“œëª…ì„ DB ì»¬ëŸ¼ëª…ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê·œì¹™ |

### 7.2 ì–´ë…¸í…Œì´ì…˜ ì •ë¦¬

ì´ ì±•í„°ì—ì„œ ì‚¬ìš©í•œ JPA ì–´ë…¸í…Œì´ì…˜ ëª©ë¡ì…ë‹ˆë‹¤.

| ì–´ë…¸í…Œì´ì…˜ | ì„¤ëª… | ì‚¬ìš© ìœ„ì¹˜ |
|-----------|------|----------|
| `@Entity` | JPA ì—”í‹°í‹° í´ë˜ìŠ¤ ì„ ì–¸ | í´ë˜ìŠ¤ |
| `@Table(name = "...")` | ë§¤í•‘í•  í…Œì´ë¸” ì´ë¦„ ì§€ì • | í´ë˜ìŠ¤ |
| `@Id` | ê¸°ë³¸ í‚¤ ë§¤í•‘ | í•„ë“œ |
| `@GeneratedValue` | PK ìë™ ìƒì„± ì „ëµ | í•„ë“œ |
| `@Column(name = "...")` | ì»¬ëŸ¼ ë§¤í•‘ (ì´ë¦„, ì œì•½ì¡°ê±´ ë“±) | í•„ë“œ |
| `@Embeddable` | ê°’ íƒ€ì… í´ë˜ìŠ¤ ì„ ì–¸ | í´ë˜ìŠ¤ |
| `@Embedded` | ê°’ íƒ€ì… í•„ë“œ ì„ ì–¸ | í•„ë“œ |
| `@OneToMany` | ì¼ëŒ€ë‹¤ ì—°ê´€ê´€ê³„ ë§¤í•‘ | í•„ë“œ |
| `@ManyToOne` | ë‹¤ëŒ€ì¼ ì—°ê´€ê´€ê³„ ë§¤í•‘ | í•„ë“œ |
| `@OneToOne` | ì¼ëŒ€ì¼ ì—°ê´€ê´€ê³„ ë§¤í•‘ | í•„ë“œ |
| `@ManyToMany` | ë‹¤ëŒ€ë‹¤ ì—°ê´€ê´€ê³„ ë§¤í•‘ (ì§€ì–‘) | í•„ë“œ |
| `@JoinColumn(name = "...")` | FK ì»¬ëŸ¼ ì´ë¦„ ì§€ì • (ì£¼ì¸ ìª½) | í•„ë“œ |
| `@JoinTable(...)` | ì¡°ì¸ í…Œì´ë¸” ì„¤ì • (M:N) | í•„ë“œ |
| `@Inheritance` | ìƒì† ë§¤í•‘ ì „ëµ ì§€ì • | í´ë˜ìŠ¤ |
| `@DiscriminatorColumn` | êµ¬ë¶„ ì»¬ëŸ¼ ì§€ì • (`dtype`) | í´ë˜ìŠ¤ |
| `@DiscriminatorValue` | êµ¬ë¶„ ì»¬ëŸ¼ ê°’ ì§€ì • | í´ë˜ìŠ¤ |
| `@Enumerated` | Enum íƒ€ì… ë§¤í•‘ | í•„ë“œ |

**fetch ì „ëµ:**

| ì „ëµ | ì–´ë…¸í…Œì´ì…˜ | ì„¤ëª… |
|------|-----------|------|
| **ì¦‰ì‹œ ë¡œë”©** | `FetchType.EAGER` | ì—°ê´€ ì—”í‹°í‹°ë¥¼ ì¦‰ì‹œ JOINí•´ì„œ ê°€ì ¸ì˜´ (ê¸°ë³¸ê°’: @ManyToOne, @OneToOne) |
| **ì§€ì—° ë¡œë”©** | `FetchType.LAZY` | ì—°ê´€ ì—”í‹°í‹°ë¥¼ ì‹¤ì œ ì‚¬ìš© ì‹œì ì— ì¿¼ë¦¬ (ê¶Œì¥) |

> **ì¤‘ìš”**: ì‹¤ì „ì—ì„œëŠ” ëª¨ë“  ì—°ê´€ê´€ê³„ë¥¼ `FetchType.LAZY`ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì„ ê°•í•˜ê²Œ ê¶Œì¥í•©ë‹ˆë‹¤.

### 7.3 ì„¤ê³„ ìš”ì•½í‘œ

| í•­ëª© | ì´ í”„ë¡œì íŠ¸ì˜ ì„¤ê³„ ê²°ì • |
|------|----------------------|
| **ìƒì† ë§¤í•‘ ì „ëµ** | ë‹¨ì¼ í…Œì´ë¸” ì „ëµ (SINGLE_TABLE) - `@Inheritance(strategy = InheritanceType.SINGLE_TABLE)` |
| **M:N ì²˜ë¦¬** | `@ManyToMany` ì‚¬ìš© (í•™ìŠµ ëª©ì ) - ì‹¤ë¬´ì—ì„œëŠ” ì¤‘ê°„ ì—”í‹°í‹° ê¶Œì¥ |
| **ê°’ íƒ€ì…** | `Address`ë¥¼ `@Embeddable`ë¡œ ì„¤ê³„, ë¶ˆë³€ìœ¼ë¡œ ì‚¬ìš© |
| **1:1 FK ìœ„ì¹˜** | ì£¼ í…Œì´ë¸”(Order)ì— FK ë°°ì¹˜ |
| **ì—°ê´€ê´€ê³„ ë°©í–¥** | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ì—­ë°©í–¥ íƒìƒ‰ì´ í•„ìš”í•œ ê²½ìš°ë§Œ ì–‘ë°©í–¥ ì„¤ì • |
| **Fetch ì „ëµ** | ëª¨ë“  ì—°ê´€ê´€ê³„ `LAZY` ë¡œë”© (ì§€ì—° ë¡œë”©) ê¸°ë³¸ ì›ì¹™ |
| **Cascade** | ìƒëª…ì£¼ê¸°ê°€ ê°™ê³  ë‹¨ì¼ ì†Œìœ ìì¸ ì—”í‹°í‹°ì—ë§Œ ì ìš© (Orderâ†’OrderItem, Orderâ†’Delivery) |
| **ì»¬ë ‰ì…˜ ì´ˆê¸°í™”** | í•„ë“œ ì„ ì–¸ ì‹œ `= new ArrayList<>()` ë¡œ ì¦‰ì‹œ ì´ˆê¸°í™” |
| **Getter/Setter** | í•™ìŠµ í¸ì˜ìƒ ëª¨ë‘ ì—´ë˜, ì‹¤ë¬´ì—ì„œëŠ” Getterë§Œ ì—´ê³  ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œ í™œìš© ê¶Œì¥ |

### 7.4 í•™ìŠµ í™•ì¸ ì§ˆë¬¸

ë‹¤ìŒ ì§ˆë¬¸ì— ë‹µí•˜ë©° í•™ìŠµ ë‚´ìš©ì„ í™•ì¸í•´ ë³´ì„¸ìš”:

1. **ì—°ê´€ê´€ê³„ ì£¼ì¸ì„ ê²°ì •í•˜ëŠ” ê¸°ì¤€ì€?**
   - FKê°€ ìˆëŠ” í…Œì´ë¸”ì˜ ì—”í‹°í‹°ê°€ ì£¼ì¸ì´ ë©ë‹ˆë‹¤.

2. **mappedByë¥¼ ì‚¬ìš©í•˜ëŠ” ìª½ì€ ì£¼ì¸ì¸ê°€, ë¹„ì£¼ì¸ì¸ê°€?**
   - ë¹„ì£¼ì¸ì…ë‹ˆë‹¤. mappedByëŠ” "ë‚˜ëŠ” ì´ í•„ë“œì— ì˜í•´ ë§¤í•‘ëœë‹¤"ëŠ” ì˜ë¯¸ë¡œ, ì½ê¸° ì „ìš©ì…ë‹ˆë‹¤.

3. **Order.deliveryì™€ Delivery.order ì¤‘ ì–´ëŠ ìª½ì´ ì£¼ì¸ì¸ê°€?**
   - `Order.delivery`ê°€ ì£¼ì¸ì…ë‹ˆë‹¤. ORDERS í…Œì´ë¸”ì— DELIVERY_ID FKê°€ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

4. **@ManyToManyë¥¼ ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ”?**
   - ì¡°ì¸ í…Œì´ë¸”ì— ì¶”ê°€ ì»¬ëŸ¼(ë“±ë¡ì¼, ë©”ëª¨ ë“±)ì„ ë„£ì„ ìˆ˜ ì—†ì–´ì„œ, ë‚˜ì¤‘ì— ë°˜ë“œì‹œ ì¤‘ê°„ ì—”í‹°í‹°ë¡œ ë°”ê¿”ì•¼ í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•©ë‹ˆë‹¤.

5. **Addressë¥¼ ì—”í‹°í‹°ê°€ ì•„ë‹Œ ê°’ íƒ€ì…(@Embeddable)ìœ¼ë¡œ ì„¤ê³„í•˜ëŠ” ì´ìœ ëŠ”?**
   - AddressëŠ” ì‹ë³„ìê°€ í•„ìš” ì—†ê³  ì†Œìœ  ì—”í‹°í‹°(Member, Delivery)ì— ì¢…ì†ë©ë‹ˆë‹¤. ê°’ íƒ€ì…ìœ¼ë¡œ ì„¤ê³„í•˜ë©´ ë³„ë„ í…Œì´ë¸” ì—†ì´ ì†Œìœ  í…Œì´ë¸”ì˜ ì»¬ëŸ¼ìœ¼ë¡œ í¼ì³ì ¸ ì¡°ì¸ì´ í•„ìš” ì—†ìŠµë‹ˆë‹¤.

6. **ë¹„ì£¼ì¸(mappedBy) ìª½ì—ì„œ ê°’ì„ ë³€ê²½í•˜ë©´ DBì— ë°˜ì˜ë˜ëŠ”ê°€?**
   - ë°˜ì˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ ì£¼ì¸ ìª½ì—ì„œ ê°’ì„ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ë§Œ ê°ì²´ì˜ ì–‘ìª½ ìƒíƒœë¥¼ ëª¨ë‘ ë§ì¶°ì£¼ëŠ” ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ ì‘ì„±ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

7. **ë‹¨ì¼ í…Œì´ë¸” ì „ëµ(SINGLE_TABLE)ì—ì„œ DTYPE ì»¬ëŸ¼ì˜ ì—­í• ì€?**
   - Bookì¸ì§€, Albumì¸ì§€, Movieì¸ì§€ êµ¬ë¶„í•˜ëŠ” ì»¬ëŸ¼ì…ë‹ˆë‹¤. `@DiscriminatorColumn`ìœ¼ë¡œ ì„¤ì •í•˜ë©°, ê° ì„œë¸Œ í´ë˜ìŠ¤ëŠ” `@DiscriminatorValue`ë¡œ ìì‹ ì˜ ê°’ì„ ì§€ì •í•©ë‹ˆë‹¤.

8. **ëª¨ë“  ì—°ê´€ê´€ê³„ë¥¼ LAZYë¡œ ì„¤ì •í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ”?**
   - EAGER ë¡œë”©ì€ N+1 ë¬¸ì œë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Order 100ê°œë¥¼ ì¡°íšŒí•  ë•Œ Memberê°€ EAGERë©´ ì¶”ê°€ SELECTê°€ 100ë²ˆ ë°œìƒí•©ë‹ˆë‹¤. LAZYë¡œ ì„¤ì • í›„ í•„ìš” ì‹œ fetch joinìœ¼ë¡œ ìµœì í™”í•©ë‹ˆë‹¤.

9. **ì»¬ë ‰ì…˜ì„ í•„ë“œì—ì„œ ì´ˆê¸°í™”í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ”?**
   - í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” persist í›„ ì»¬ë ‰ì…˜ì„ PersistentBag ë“± ìì²´ êµ¬í˜„ì²´ë¡œ ë˜í•‘í•©ë‹ˆë‹¤. setterë¡œ ì»¬ë ‰ì…˜ì„ êµì²´í•˜ë©´ ì´ ë˜í•‘ì´ í’€ë ¤ ì˜ì†ì„± ê´€ë ¨ ê¸°ëŠ¥ì´ ì†ìƒë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

10. **Cascadeë¥¼ Orderâ†’Itemì— ì ìš©í•˜ë©´ ì•ˆ ë˜ëŠ” ì´ìœ ëŠ”?**
    - Itemì€ ì—¬ëŸ¬ OrderItemì´ ê³µìœ í•˜ëŠ” ì—”í‹°í‹°ì…ë‹ˆë‹¤. Order ì‚­ì œ ì‹œ Itemê¹Œì§€ ì‚­ì œë˜ë©´ ë‹¤ë¥¸ OrderItemì—ì„œ ì°¸ì¡°í•˜ë˜ Itemë„ ì‚¬ë¼ì ¸ ë°ì´í„°ê°€ ì˜¤ì—¼ë©ë‹ˆë‹¤.

### 7.5 ë‹¤ìŒ ì±•í„° ì˜ˆê³ 

**ì±•í„° 3: ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬í˜„ ì¤€ë¹„**

ë„ë©”ì¸ ì„¤ê³„ì™€ ì—”í‹°í‹° êµ¬í˜„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì±•í„°ì—ì„œëŠ” ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ **ê³„ì¸µí˜• ì•„í‚¤í…ì²˜**ë¥¼ ì„¤ê³„í•˜ê³  ì¤€ë¹„í•©ë‹ˆë‹¤.

```
ì—”í‹°í‹° êµ¬í˜„ ì™„ë£Œ (ì´ë²ˆ ì±•í„°)
    â†“
ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬í˜„ ì¤€ë¹„ (ë‹¤ìŒ ì±•í„°)
    â”œâ”€â”€ ì•„í‚¤í…ì²˜ êµ¬ì„±
    â”‚   â”œâ”€â”€ ê³„ì¸µí˜• ì•„í‚¤í…ì²˜ ì´í•´
    â”‚   â”‚   â”œâ”€â”€ Controller  (ì›¹ ê³„ì¸µ)
    â”‚   â”‚   â”œâ”€â”€ Service     (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
    â”‚   â”‚   â”œâ”€â”€ Repository  (JPA ì§ì ‘ ì‚¬ìš©)
    â”‚   â”‚   â””â”€â”€ Domain      (ì—”í‹°í‹°, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í¬í•¨)
    â”‚   â””â”€â”€ íŒ¨í‚¤ì§€ êµ¬ì¡° ì¤€ë¹„
    â”‚       â”œâ”€â”€ jpabook.jpashop.repository/
    â”‚       â”œâ”€â”€ jpabook.jpashop.service/
    â”‚       â””â”€â”€ jpabook.jpashop.web/
    â””â”€â”€ ê°œë°œ ë°©í–¥
        â”œâ”€â”€ Repository â†’ Service â†’ Test ìˆœì„œë¡œ ê°œë°œ
        â”œâ”€â”€ íšŒì› ë„ë©”ì¸ë¶€í„° ì‹œì‘ (ê°€ì¥ ë‹¨ìˆœ)
        â””â”€â”€ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ë™ì‘ ê²€ì¦
```

**ë‹¤ìŒ ì±•í„° ì´í›„ íë¦„:**

| ì±•í„° | ë‚´ìš© |
|------|------|
| 4. íšŒì› ë„ë©”ì¸ ê°œë°œ | MemberRepository, MemberService, íšŒì› í…ŒìŠ¤íŠ¸ |
| 5. ìƒí’ˆ ë„ë©”ì¸ ê°œë°œ | ItemRepository, ItemService, ìƒí’ˆ í…ŒìŠ¤íŠ¸ |
| 6. ì£¼ë¬¸ ë„ë©”ì¸ ê°œë°œ | OrderRepository, OrderService, ì£¼ë¬¸ í…ŒìŠ¤íŠ¸ |
| 7. ì›¹ ê³„ì¸µ ê°œë°œ | MemberController, OrderController, Thymeleaf ë·° |

---

*ì‘ì„±ì¼: 2026-02-24 / ìµœì¢… ìˆ˜ì •: 2026-03-01*
*ê°•ì˜: ì¸í”„ëŸ° - ê¹€ì˜í•œì˜ ì‹¤ì „! ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ JPA í™œìš© 1*
*ì±•í„°: 2. ë„ë©”ì¸ ë¶„ì„ ì„¤ê³„ (ìš”êµ¬ì‚¬í•­ ë¶„ì„ â†’ ì—”í‹°í‹° í´ë˜ìŠ¤ êµ¬í˜„ + ì„¤ê³„ ì£¼ì˜ì  ì „ì²´)*
